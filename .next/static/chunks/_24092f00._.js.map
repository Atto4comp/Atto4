{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-common.ts"],"sourcesContent":["// lib/api/video-common.ts\nimport axios from 'axios';\n\n/**\n * Shared utilities, types and helpers for video APIs\n */\n\nexport interface VideoSource {\n  url: string;\n  quality: string;\n  type: \"iframe\";\n  servers: string;\n  tmdbId: number;\n  mediaType: \"movie\" | \"tv\";\n  season?: number;\n  episode?: number;\n  title?: string;\n  episodeTitle?: string;\n  responseTime?: number;\n  working?: boolean;\n  error?: string;\n  provider?: string;\n}\n\nexport interface VideoProvider {\n  name: string;\n  value: string;\n  priority: number;\n  mediaTypes: (\"movie\" | \"tv\")[];\n  isTemplate: boolean;\n  hostname: string;\n}\n\nexport interface EmbedCheckResponse {\n  success: boolean;\n  workingUrl?: {\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n  } | null;\n  totalTested: number;\n  workingCount: number;\n  allUrls: Array<{\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n    working: boolean;\n    responseTime?: number;\n    error?: string;\n  }>;\n  metadata: {\n    mediaType: string;\n    tmdbId: number;\n    season?: number;\n    episode?: number;\n    tested: boolean;\n    timestamp: string;\n  };\n}\n\n/** Shared ENV (generic fallback providers) */\nexport const COMMON_ENV = {\n  BASE: (process.env.NEXT_PUBLIC_VIDEO_API_BASE || \"\").trim(),\n  E1: (process.env.NEXT_PUBLIC_VIDEO_EMBED_1 || \"\").trim(),\n  E2: (process.env.NEXT_PUBLIC_VIDEO_EMBED_2 || \"\").trim(),\n  E3: (process.env.NEXT_PUBLIC_VIDEO_EMBED_3 || \"\").trim(),\n  E4: (process.env.NEXT_PUBLIC_VIDEO_EMBED_4 || \"\").trim(),\n  TMDB_API_KEY: (process.env.NEXT_PUBLIC_TMDB_API_KEY || \"\").trim()\n};\n\nexport const EXTRA_PARAMS = (process.env.NEXT_PUBLIC_VIDEO_URL_PARAMS || \"\").trim();\n\n/** Helpers */\nfunction isTemplateLocal(url?: string) {\n  if (!url) return false;\n  return /\\$\\{(id|type|season|episode)\\}/.test(url);\n}\n\nexport function getServerLabel(url: string): string {\n  if (!url) return 'Unknown Server';\n  try {\n    const hostname = new URL(url).hostname;\n    return hostname.replace(/^www\\./, '');\n  } catch {\n    return 'Unknown Server';\n  }\n}\n\nexport function normalizeBase(url: string) {\n  if (!url) return '';\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n\nexport function appendParams(url: string, params: string) {\n  if (!params) return url;\n  return url + (url.includes('?') ? '&' : '?') + params;\n}\n\nexport function buildEmbedPath(mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  if (mediaType === 'movie') return `/movie/${tmdbId}`;\n  if (mediaType === 'tv') {\n    if (season && episode) return `/tv/${tmdbId}/${season}/${episode}`;\n    return `/tv/${tmdbId}`;\n  }\n  throw new Error('invalid mediaType');\n}\n\nexport function buildRawUrl(providerValue: string, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  if (!providerValue) throw new Error('providerValue required');\n  if (isTemplateLocal(providerValue)) {\n    return providerValue\n      .replace(/\\$\\{id\\}/g, String(tmdbId))\n      .replace(/\\$\\{type\\}/g, mediaType)\n      .replace(/\\$\\{season\\}/g, String(season || 1))\n      .replace(/\\$\\{episode\\}/g, String(episode || 1));\n  }\n  const base = normalizeBase(providerValue);\n  const path = buildEmbedPath(mediaType, tmdbId, season, episode);\n  return `${base}${path}`;\n}\n\nexport function buildEmbedUrl(providerValue: string, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  const raw = buildRawUrl(providerValue, mediaType, tmdbId, season, episode);\n  return appendParams(raw, EXTRA_PARAMS);\n}\n\nexport function getEmbedUrlCandidatesFromProviders(providers: VideoProvider[], mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  const urls = providers.map(p => buildEmbedUrl(p.value, mediaType, tmdbId, season, episode));\n  return [...new Set(urls)];\n}\n\n/** Fallback provider list built from COMMON_ENV (used if module-specific providers are missing) */\nexport const COMMON_PROVIDERS: VideoProvider[] = [\n  { name: 'Primary', value: COMMON_ENV.E1, priority: 1, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E1), hostname: getServerLabel(COMMON_ENV.E1) },\n  { name: 'Secondary', value: COMMON_ENV.E2, priority: 2, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E2), hostname: getServerLabel(COMMON_ENV.E2) },\n  { name: 'Tertiary', value: COMMON_ENV.E3, priority: 3, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E3), hostname: getServerLabel(COMMON_ENV.E3) },\n  { name: 'Backup', value: COMMON_ENV.E4, priority: 4, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E4), hostname: getServerLabel(COMMON_ENV.E4) },\n  { name: 'Base', value: COMMON_ENV.BASE, priority: 5, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.BASE), hostname: getServerLabel(COMMON_ENV.BASE) }\n].filter(p => !!p.value);\n\n/** checkEmbedUrls helper (client convenience: calls your /api/check-embed route) */\nexport async function checkEmbedUrls(mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number, testUrls: boolean = true): Promise<EmbedCheckResponse | null> {\n  try {\n    const res = await fetch('/api/check-embed', {\n      method: 'POST',\n      headers: {'content-type':'application/json'},\n      body: JSON.stringify({ mediaType, tmdbId, season, episode, testUrls })\n    });\n    if (!res.ok) return null;\n    const payload = await res.json();\n    return payload as EmbedCheckResponse;\n  } catch (err) {\n    console.error('checkEmbedUrls error', err);\n    return null;\n  }\n}\n\n/** resolveTmdbId helper (numeric or imdb -> tmdb) */\nexport async function resolveTmdbId(input: string | number, type: \"movie\" | \"tv\"): Promise<number | null> {\n  if (typeof input === 'number' && Number.isFinite(input)) return input;\n  const s = String(input).trim();\n  if (!s) return null;\n  const asNum = Number(s);\n  if (Number.isFinite(asNum)) return asNum;\n  if (/^tt\\d+$/i.test(s)) {\n    if (!COMMON_ENV.TMDB_API_KEY) return null;\n    try {\n      const { data } = await axios.get(`https://api.themoviedb.org/3/find/${s}`, {\n        params: { api_key: COMMON_ENV.TMDB_API_KEY, external_source: 'imdb_id' },\n        timeout: 5000\n      });\n      const results = type === 'movie' ? data.movie_results : data.tv_results;\n      return results?.[0]?.id ?? null;\n    } catch (err) {\n      console.warn('resolveTmdbId failed', err);\n      return null;\n    }\n  }\n  return null;\n}\n\n/** create VideoSource object */\nexport function createVideoSourceFromProvider(provider: VideoProvider, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number, additional: Partial<VideoSource> = {}): VideoSource {\n  const url = buildEmbedUrl(provider.value, mediaType, tmdbId, season, episode);\n  return {\n    url,\n    quality: 'HD',\n    type: 'iframe',\n    servers: `${provider.name} (${provider.hostname})`,\n    tmdbId,\n    mediaType,\n    season,\n    episode,\n    provider: provider.name,\n    ...additional\n  };\n}\n\n/** config validator */\nexport function validateConfiguration(providers: VideoProvider[] = COMMON_PROVIDERS) {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n  if (!providers || providers.length === 0) errors.push('No providers configured');\n  if (!COMMON_ENV.TMDB_API_KEY) warnings.push('TMDB API key not set (imdb resolution disabled)');\n  return { isValid: errors.length === 0, errors, warnings };\n}\n\nexport { COMMON_ENV as ENV, COMMON_PROVIDERS };\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-movie.ts"],"sourcesContent":["// lib/api/video-movie.ts\nimport axios from 'axios';\nimport {\n  VideoSource,\n  VideoProvider,\n  EmbedCheckResponse,\n  createVideoSourceFromProvider,\n  buildEmbedUrl,\n  getEmbedUrlCandidatesFromProviders,\n  resolveTmdbId,\n  checkEmbedUrls,\n  validateConfiguration,\n  getServerLabel,\n  COMMON_PROVIDERS\n} from './video-common';\n\n/**\n * Movie-specific provider/env processing.\n * Module looks for NEXT_PUBLIC_MOVIE_EMBED_1..4 and NEXT_PUBLIC_MOVIE_API_BASE\n * If not present, falls back to COMMON_PROVIDERS.\n */\n\n/** Build providers from env if present */\nfunction buildMovieProviders(): VideoProvider[] {\n  const E1 = (process.env.NEXT_PUBLIC_MOVIE_EMBED_1 || \"https://cinemaos.tech/player/${id}\").trim();\n  const E2 = (process.env.NEXT_PUBLIC_MOVIE_EMBED_2 || \"\").trim();\n  const E3 = (process.env.NEXT_PUBLIC_MOVIE_EMBED_3 || \"\").trim();\n  const E4 = (process.env.NEXT_PUBLIC_MOVIE_EMBED_4 || \"\").trim();\n  const BASE = (process.env.NEXT_PUBLIC_MOVIE_API_BASE || \"\").trim();\n\n  const items: VideoProvider[] = [\n    { name: 'Primary', value: E1, priority: 1, mediaTypes: ['movie'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E1), hostname: getServerLabel(E1) },\n    { name: 'Secondary', value: E2, priority: 2, mediaTypes: ['movie'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E2), hostname: getServerLabel(E2) },\n    { name: 'Tertiary', value: E3, priority: 3, mediaTypes: ['movie'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E3), hostname: getServerLabel(E3) },\n    { name: 'Backup', value: E4, priority: 4, mediaTypes: ['movie'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E4), hostname: getServerLabel(E4) },\n    { name: 'Base', value: BASE, priority: 5, mediaTypes: ['movie'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(BASE), hostname: getServerLabel(BASE) }\n  ].filter(p => !!p.value);\n\n  // if none specified, fall back to common providers that support movie\n  if (items.length === 0) {\n    return COMMON_PROVIDERS.filter(p => p.mediaTypes.includes('movie'));\n  }\n  return items;\n}\n\n/** Get movie providers (computed) */\nconst MOVIE_PROVIDERS = buildMovieProviders();\n\n/** Build VideoSource list for a movie */\nexport async function getMovieSources(tmdbId: number): Promise<VideoSource[]> {\n  if (!tmdbId || tmdbId <= 0) throw new Error(`Invalid movie TMDB ID: ${tmdbId}`);\n  const cfg = validateConfiguration(MOVIE_PROVIDERS);\n  if (!cfg.isValid) throw new Error('video configuration invalid: ' + cfg.errors.join('; '));\n\n  const sources = MOVIE_PROVIDERS.map(provider => {\n    const s = createVideoSourceFromProvider(provider, 'movie', tmdbId, undefined, undefined, { title: `Movie ${tmdbId}` });\n    s.servers = `${provider.name} (${provider.hostname || getServerLabel(provider.value)})`;\n    s.provider = provider.name;\n    return s;\n  });\n\n  return sources;\n}\n\n/** Test via server-side /api/check-embed (optional) and map results */\nexport async function getMovieSourcesWithTesting(tmdbId: number, testUrls: boolean = true): Promise<{\n  sources: VideoSource[];\n  workingSources: VideoSource[];\n  embedCheckData: EmbedCheckResponse | null;\n}> {\n  const sources = await getMovieSources(tmdbId);\n  if (!testUrls) return { sources, workingSources: sources, embedCheckData: null };\n\n  const check = await checkEmbedUrls('movie', tmdbId, undefined, undefined, true);\n  if (!check) return { sources, workingSources: sources, embedCheckData: null };\n\n  const workingSources = check.allUrls.filter(u => u.working).map(u => {\n    const original = sources.find(s => s.url === u.originalUrl) || sources[0];\n    return { ...original, url: u.url, working: u.working, responseTime: u.responseTime, error: u.error, provider: u.provider, servers: `${u.provider} (${u.working ? 'Working' : 'Failed'})` };\n  });\n\n  return { sources, workingSources, embedCheckData: check };\n}\n\n/** Get movie metadata + best embed (first working or first) */\nexport async function getMovieWithEmbed(tmdbIdInput: number | string, testUrls: boolean = true) {\n  const tmdbId = await resolveTmdbId(tmdbIdInput, 'movie');\n  if (!tmdbId) throw new Error('unresolvable tmdb id');\n\n  // fetch TMDB metadata (optional)\n  const API_KEY = process.env.NEXT_PUBLIC_TMDB_API_KEY?.trim();\n  const movieResp = API_KEY ? await axios.get(`https://api.themoviedb.org/3/movie/${tmdbId}`, { params: { api_key: API_KEY }, timeout: 10000 }).catch(()=>({data:null})) : { data: null };\n\n  const { sources, workingSources, embedCheckData } = await getMovieSourcesWithTesting(tmdbId, testUrls);\n\n  if (movieResp?.data?.title) {\n    sources.forEach(s => s.title = movieResp.data.title);\n    workingSources.forEach(s => s.title = movieResp.data.title);\n  }\n\n  const embedUrl = workingSources[0]?.url || sources[0]?.url || '';\n\n  return {\n    movie: movieResp?.data,\n    embedUrl,\n    sources,\n    workingSources,\n    embedCheckData,\n    metadata: {\n      tmdbId,\n      mediaType: 'movie' as const,\n      title: movieResp?.data?.title,\n      sourcesAvailable: sources.length,\n      workingSourcesCount: workingSources.length,\n      tested: testUrls,\n      timestamp: new Date().toISOString()\n    }\n  };\n}\n\n/** Helpers */\nexport function getMovieEmbedCandidates(tmdbId: number) {\n  return getEmbedUrlCandidatesFromProviders(MOVIE_PROVIDERS, 'movie', tmdbId);\n}\n\nexport const movieVideoApi = {\n  getMovieSources,\n  getMovieSourcesWithTesting,\n  getMovieWithEmbed,\n  getMovieEmbedCandidates\n};\n\nexport default movieVideoApi;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 423, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-tv.ts"],"sourcesContent":["// lib/api/video-tv.ts\nimport axios from 'axios';\nimport {\n  VideoSource,\n  VideoProvider,\n  EmbedCheckResponse,\n  createVideoSourceFromProvider,\n  getEmbedUrlCandidatesFromProviders,\n  resolveTmdbId,\n  checkEmbedUrls,\n  validateConfiguration,\n  getServerLabel,\n  COMMON_PROVIDERS\n} from './video-common';\n\n/** Build TV providers from env (module-level) */\nfunction buildTVProviders(): VideoProvider[] {\n  const E1 = (process.env.NEXT_PUBLIC_TV_EMBED_1 || \"https://cinemaos.tech/player/${id}/${season}/${episode}\").trim();\n  const E2 = (process.env.NEXT_PUBLIC_TV_EMBED_2 || \"\").trim();\n  const E3 = (process.env.NEXT_PUBLIC_TV_EMBED_3 || \"\").trim();\n  const E4 = (process.env.NEXT_PUBLIC_TV_EMBED_4 || \"\").trim();\n  const BASE = (process.env.NEXT_PUBLIC_TV_API_BASE || \"\").trim();\n\n  const items: VideoProvider[] = [\n    { name: 'Primary', value: E1, priority: 1, mediaTypes: ['tv'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E1), hostname: getServerLabel(E1) },\n    { name: 'Secondary', value: E2, priority: 2, mediaTypes: ['tv'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E2), hostname: getServerLabel(E2) },\n    { name: 'Tertiary', value: E3, priority: 3, mediaTypes: ['tv'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E3), hostname: getServerLabel(E3) },\n    { name: 'Backup', value: E4, priority: 4, mediaTypes: ['tv'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(E4), hostname: getServerLabel(E4) },\n    { name: 'Base', value: BASE, priority: 5, mediaTypes: ['tv'], isTemplate: /\\$\\{(id|type|season|episode)\\}/.test(BASE), hostname: getServerLabel(BASE) }\n  ].filter(p => !!p.value);\n\n  if (items.length === 0) {\n    return COMMON_PROVIDERS.filter(p => p.mediaTypes.includes('tv'));\n  }\n  return items;\n}\n\nconst TV_PROVIDERS = buildTVProviders();\n\n/** Get TV sources for a given S/E */\nexport async function getTVSources(tmdbId: number, season?: number, episode?: number): Promise<VideoSource[]> {\n  if (!tmdbId || tmdbId <= 0) throw new Error(`Invalid TV TMDB ID: ${tmdbId}`);\n  const sNum = season || 1;\n  const eNum = episode || 1;\n\n  const cfg = validateConfiguration(TV_PROVIDERS);\n  if (!cfg.isValid) throw new Error('video configuration invalid: ' + cfg.errors.join('; '));\n\n  const sources = TV_PROVIDERS.map(provider => {\n    const src = createVideoSourceFromProvider(provider, 'tv', tmdbId, sNum, eNum, { title: `TV ${tmdbId}`, episodeTitle: `S${sNum}E${eNum}` });\n    src.servers = `${provider.name} (${provider.hostname || getServerLabel(provider.value)})`;\n    src.provider = provider.name;\n    return src;\n  });\n\n  return sources;\n}\n\n/** Test via /api/check-embed and map results */\nexport async function getTVSourcesWithTesting(tmdbId: number, season?: number, episode?: number, testUrls: boolean = true) {\n  const sources = await getTVSources(tmdbId, season, episode);\n  if (!testUrls) return { sources, workingSources: sources, embedCheckData: null as EmbedCheckResponse | null };\n\n  const check = await checkEmbedUrls('tv', tmdbId, season, episode, true);\n  if (!check) return { sources, workingSources: sources, embedCheckData: null };\n\n  const workingSources = check.allUrls.filter(u => u.working).map(u => {\n    const original = sources.find(s => s.url === u.originalUrl) || sources[0];\n    return { ...original, url: u.url, working: u.working, responseTime: u.responseTime, error: u.error, provider: u.provider, servers: `${u.provider} (${u.working ? 'Working' : 'Failed'})` };\n  });\n\n  return { sources, workingSources, embedCheckData: check };\n}\n\n/** Get episode / tv metadata + embed selection */\nexport async function getTVShowWithEmbed(tmdbIdInput: number | string, season?: number, episode?: number, testUrls: boolean = true) {\n  const tmdbId = await resolveTmdbId(tmdbIdInput, 'tv');\n  if (!tmdbId) throw new Error('unresolvable tmdb id');\n\n  const sNum = season || 1;\n  const eNum = episode || 1;\n\n  // optionally fetch tv/episode metadata (if api key present)\n  const API_KEY = process.env.NEXT_PUBLIC_TMDB_API_KEY?.trim();\n  let tvInfo: any = null;\n  if (API_KEY) {\n    try {\n      const [ep, seas, show] = await Promise.all([\n        axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}/season/${sNum}/episode/${eNum}`, { params: { api_key: API_KEY }, timeout: 8000 }).catch(()=>({data:null})),\n        axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}/season/${sNum}`, { params: { api_key: API_KEY }, timeout: 8000 }).catch(()=>({data:null})),\n        axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}`, { params: { api_key: API_KEY }, timeout: 8000 }).catch(()=>({data:null}))\n      ]);\n      tvInfo = { episode: ep.data, season: seas.data, show: show.data };\n    } catch (err) {\n      tvInfo = null;\n    }\n  }\n\n  const { sources, workingSources, embedCheckData } = await getTVSourcesWithTesting(tmdbId, sNum, eNum, testUrls);\n\n  if (tvInfo?.show?.name || tvInfo?.episode?.name) {\n    const showTitle = tvInfo.show?.name;\n    const episodeTitle = tvInfo.episode?.name;\n    sources.forEach(s => { s.title = showTitle; s.episodeTitle = episodeTitle || `S${sNum}E${eNum}`; });\n    workingSources.forEach(s => { s.title = showTitle; s.episodeTitle = episodeTitle || `S${sNum}E${eNum}`; });\n  }\n\n  const embedUrl = workingSources[0]?.url || sources[0]?.url || '';\n\n  return {\n    tvShow: tvInfo?.show,\n    episode: tvInfo?.episode,\n    season: tvInfo?.season,\n    embedUrl,\n    sources,\n    workingSources,\n    embedCheckData,\n    metadata: {\n      tmdbId,\n      mediaType: 'tv' as const,\n      season: sNum,\n      episode: eNum,\n      title: tvInfo?.show?.name,\n      episodeTitle: tvInfo?.episode?.name,\n      tested: testUrls,\n      timestamp: new Date().toISOString(),\n      sourcesAvailable: sources.length,\n      workingSourcesCount: workingSources.length\n    }\n  };\n}\n\n/** Helpers */\nexport function getTVEmbedCandidates(tmdbId: number, season?: number, episode?: number) {\n  return getEmbedUrlCandidatesFromProviders(TV_PROVIDERS, 'tv', tmdbId, season, episode);\n}\n\nexport const tvVideoApi = {\n  getTVSources,\n  getTVSourcesWithTesting,\n  getTVShowWithEmbed,\n  getTVEmbedCandidates\n};\n\nexport default tvVideoApi;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 653, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-api.ts"],"sourcesContent":["// lib/api/video-api.ts\n/**\n * Backwards-compatible shim that delegates to movie/tv APIs.\n * Prefer importing movieVideoApi or tvVideoApi directly from video-movie / video-tv.\n */\n\nexport * from './video-common';\nexport * from './video-movie';\nexport * from './video-tv';\n\nimport * as movieModule from './video-movie';\nimport * as tvModule from './video-tv';\nimport * as commonModule from './video-common';\n\nfunction fnOrFallback(maybeFn: any, fallback: any) {\n  return typeof maybeFn === 'function' ? maybeFn : fallback;\n}\n\nconst noopAsync = async (..._args: any[]) => null;\nconst returnEmptyArray = async (..._args: any[]) => [];\nconst returnFalse = () => false;\nconst returnEmptyObject = () => ({});\nconst returnEmptyString = () => \"\";\n\nconst movie = {\n  getMovieSources: fnOrFallback(movieModule.getMovieSources, returnEmptyArray),\n  getMovieSourcesWithTesting: fnOrFallback(movieModule.getMovieSourcesWithTesting, movieModule.getMovieSources ?? returnEmptyArray),\n  getMovieWithEmbed: fnOrFallback(movieModule.getMovieWithEmbed, noopAsync),\n  getMovieEmbedCandidates: fnOrFallback(movieModule.getMovieEmbedCandidates, (id:number) => (commonModule.getEmbedUrlCandidatesFromProviders ? commonModule.getEmbedUrlCandidatesFromProviders((commonModule as any).COMMON_PROVIDERS || [], 'movie', id) : [])),\n  hasMovieSourcesConfigured: fnOrFallback((movieModule as any).hasMovieProviders ?? (() => false), () => false),\n};\n\nconst tv = {\n  getTVSources: fnOrFallback(tvModule.getTVSources, returnEmptyArray),\n  getTVSourcesWithTesting: fnOrFallback(tvModule.getTVSourcesWithTesting, tvModule.getTVSources ?? returnEmptyArray),\n  getTVShowWithEmbed: fnOrFallback(tvModule.getTVShowWithEmbed, noopAsync),\n  getTVEmbedCandidates: fnOrFallback(tvModule.getTVEmbedCandidates, (id:number,s?:number,e?:number) => (commonModule.getEmbedUrlCandidatesFromProviders ? commonModule.getEmbedUrlCandidatesFromProviders((commonModule as any).COMMON_PROVIDERS || [], 'tv', id, s, e) : [])),\n  hasTVSourcesConfigured: fnOrFallback((tvModule as any).hasTVProviders ?? (() => false), () => false),\n};\n\nconst common = {\n  getEmbedUrlCandidatesFromProviders: fnOrFallback((commonModule as any).getEmbedUrlCandidatesFromProviders, () => []),\n  checkEmbedUrls: fnOrFallback((commonModule as any).checkEmbedUrls, async () => null),\n  getConfigurationStatus: fnOrFallback((commonModule as any).getConfigurationStatus ?? (() => ({})), () => ({})),\n  validateConfiguration: fnOrFallback((commonModule as any).validateConfiguration ?? (() => ({ isValid:false, errors:[], warnings:[] })), () => ({ isValid:false, errors:[], warnings:[] })),\n  VIDEO_PROVIDERS: (commonModule as any).COMMON_PROVIDERS || []\n};\n\nexport const videoApi = {\n  async getMovieSources(tmdbId: number) { return movie.getMovieSources(tmdbId); },\n  async getMovieSourcesWithTesting(tmdbId: number) { return movie.getMovieSourcesWithTesting(tmdbId); },\n  async getMovieWithEmbed(tmdbId: number) { return movie.getMovieWithEmbed(tmdbId); },\n\n  async getTVSources(tmdbId: number, season?: number, episode?: number) { return tv.getTVSources(tmdbId, season, episode); },\n  async getTVSourcesWithTesting(tmdbId: number, season?: number, episode?: number) { return tv.getTVSourcesWithTesting(tmdbId, season, episode); },\n  async getTVShowWithEmbed(tmdbId: number, season?: number, episode?: number) { return tv.getTVShowWithEmbed(tmdbId, season, episode); },\n\n  hasConfiguredApis() { return Array.isArray(common.VIDEO_PROVIDERS) && common.VIDEO_PROVIDERS.length > 0; },\n  getConfigStatus() { return common.getConfigurationStatus(); },\n  getEmbedUrlCandidates(mediaType: 'movie'|'tv', tmdbId: number, season?: number, episode?: number) { return common.getEmbedUrlCandidatesFromProviders(common.VIDEO_PROVIDERS || [], mediaType, tmdbId, season, episode); },\n  logConfiguration() { if (typeof (commonModule as any).logConfiguration === 'function') (commonModule as any).logConfiguration(); },\n\n  movie,\n  tv,\n  common\n};\n\nexport default videoApi;\n\n/** Named legacy exports */\nexport const getMovieSources = movie.getMovieSources;\nexport const getMovieSourcesWithTesting = movie.getMovieSourcesWithTesting;\nexport const getMovieWithEmbed = movie.getMovieWithEmbed;\nexport const getTVSources = tv.getTVSources;\nexport const getTVSourcesWithTesting = tv.getTVSourcesWithTesting;\nexport const getTVShowWithEmbed = tv.getTVShowWithEmbed;\nexport const checkEmbedUrls = common.checkEmbedUrls;\nexport const VIDEO_PROVIDERS = common.VIDEO_PROVIDERS;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 790, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/hooks/useEmbedAutoSwitch.ts"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { getMovieSources, getTVSources } from '@/lib/api/video-api';\n\ntype MediaType = 'movie' | 'tv';\n\ntype ServerResult =\n  | string\n  | { url: string; working?: boolean; responseTimeMs?: number; status?: number; probe?: 'HEAD'|'GET' };\n\ninterface UseEmbedAutoSwitchArgs {\n  mediaType: MediaType;\n  mediaId: number;\n  season?: number;\n  episode?: number;\n  guardMs?: number;          // iframe load guard (auto switch) — default 6000\n  preferServer?: boolean;    // use /api/check-embed first — default true\n}\n\nexport function useEmbedAutoSwitch({\n  mediaType,\n  mediaId,\n  season,\n  episode,\n  guardMs = 6000,\n  preferServer = true,\n}: UseEmbedAutoSwitchArgs) {\n  const [candidates, setCandidates] = useState<string[]>([]);\n  const [index, setIndex] = useState(0);\n  const [src, setSrc] = useState<string>('');\n  const failed = useRef<Set<number>>(new Set());\n  const timer = useRef<number | null>(null);\n  const attemptId = useRef(0);\n  const mounted = useRef(true);\n\n  const clearGuard = useCallback(() => {\n    if (timer.current != null) {\n      window.clearTimeout(timer.current);\n      timer.current = null;\n    }\n  }, []);\n\n  const startGuard = useCallback((i: number) => {\n    clearGuard();\n    const thisAttempt = ++attemptId.current;\n    timer.current = window.setTimeout(() => {\n      // if still same attempt and not loaded — mark failed & next\n      if (attemptId.current === thisAttempt) {\n        failed.current.add(i);\n        // try next\n        let next = -1;\n        for (let step = 1; step <= candidates.length; step++) {\n          const cand = (i + step) % candidates.length;\n          if (!failed.current.has(cand)) { next = cand; break; }\n        }\n        if (next >= 0) {\n          setIndex(next);\n          setSrc(candidates[next]);\n          startGuard(next);\n        }\n      }\n    }, guardMs) as unknown as number;\n  }, [candidates, guardMs, clearGuard]);\n\n  // load candidate list\n  useEffect(() => {\n    mounted.current = true;\n    failed.current.clear();\n    setCandidates([]);\n    setIndex(0);\n    setSrc('');\n\n    (async () => {\n      let list: string[] = [];\n\n      // 1) server-probed list\n      if (preferServer) {\n        try {\n          const res = await fetch('/api/check-embed', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n              mediaType,\n              tmdbId: mediaId,\n              season: season || 1,\n              episode: episode || 1,\n              timeoutMs: 4000,\n              retries: 0,\n            }),\n          });\n\n          if (res.ok) {\n            const data = await res.json();\n            // Accept either plain string array or array of objects\n            const urls: ServerResult[] = Array.isArray(data.urls) ? data.urls : [];\n            const normalized = urls.map(u => (typeof u === 'string' ? u : u?.url)).filter(Boolean) as string[];\n            // Put workingUrl first if present and not already at front\n            const first = typeof data.workingUrl === 'string' ? data.workingUrl : (data.workingUrl?.url ?? null);\n            if (first) {\n              list = [first, ...normalized.filter(u => u !== first)];\n            } else {\n              list = normalized;\n            }\n          }\n        } catch {\n          // ignore; fallback below\n        }\n      }\n\n      // 2) fallback to local providers if needed\n      if (list.length === 0) {\n        const fallback = mediaType === 'movie'\n          ? await getMovieSources(mediaId)\n          : await getTVSources(mediaId, season || 1, episode || 1);\n        list = (fallback || []).map(s => s.url).filter(Boolean);\n      }\n\n      list = Array.from(new Set(list)); // unique in order\n\n      if (!mounted.current) return;\n\n      setCandidates(list);\n      if (list.length > 0) {\n        setIndex(0);\n        setSrc(list[0]);\n        startGuard(0);\n      }\n    })();\n\n    return () => {\n      mounted.current = false;\n      clearGuard();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mediaId, mediaType, season, episode, preferServer, guardMs]);\n\n  const onLoad = useCallback(() => {\n    clearGuard();\n    // current index succeeded; clear failure flag\n    failed.current.delete(index);\n  }, [index, clearGuard]);\n\n  const onError = useCallback(() => {\n    clearGuard();\n    failed.current.add(index);\n    // pick next\n    let next = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index + step) % candidates.length;\n      if (!failed.current.has(cand)) { next = cand; break; }\n    }\n    if (next >= 0) {\n      setIndex(next);\n      setSrc(candidates[next]);\n      startGuard(next);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  // optional manual controls\n  const next = useCallback(() => {\n    clearGuard();\n    let nextIdx = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index + step) % candidates.length;\n      if (!failed.current.has(cand)) { nextIdx = cand; break; }\n    }\n    if (nextIdx >= 0) {\n      setIndex(nextIdx);\n      setSrc(candidates[nextIdx]);\n      startGuard(nextIdx);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  const prev = useCallback(() => {\n    clearGuard();\n    let prevIdx = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index - step + candidates.length) % candidates.length;\n      if (!failed.current.has(cand)) { prevIdx = cand; break; }\n    }\n    if (prevIdx >= 0) {\n      setIndex(prevIdx);\n      setSrc(candidates[prevIdx]);\n      startGuard(prevIdx);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  return {\n    src,\n    index,\n    total: candidates.length,\n    onLoad,\n    onError,\n    next,\n    prev,\n    setIndex, // if you want to jump\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1040, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/MoviePlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useEmbedAutoSwitch } from '@/lib/hooks/useEmbedAutoSwitch';\n\ninterface MoviePlayerProps {\n  mediaId: number;\n  title?: string;\n  onClose?: () => void;\n  guardMs?: number;\n  showControls?: boolean;\n}\n\nexport default function MoviePlayer({\n  mediaId,\n  title,\n  onClose,\n  guardMs = 6000,\n  showControls = true,\n}: MoviePlayerProps) {\n  const router = useRouter();\n  const { src, index, total, onLoad, onError, next, prev } = useEmbedAutoSwitch({\n    mediaType: 'movie',\n    mediaId,\n    guardMs,\n    preferServer: true,\n  });\n\n  const handleClose = () => (onClose ? onClose() : router.back());\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {src ? (\n        <>\n          <iframe\n            key={src}\n            src={src}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"autoplay; encrypted-media; picture-in-picture\"\n            onLoad={onLoad}\n            onError={onError}\n            style={{ border: 'none' }}\n            title={title || `movie-${mediaId}`}\n          />\n\n          {/* Back + Title */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 text-white\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg truncate max-w-xs\">{title}</h1>\n            )}\n          </div>\n\n          {/* Minimal overlay */}\n          <div className=\"absolute top-4 right-4 z-30 text-white/80 text-sm flex items-center gap-3\">\n            <div>Auto-switch enabled — Press ESC to exit</div>\n            <div className=\"text-xs ml-2\">Source {index + 1}/{total || 0}</div>\n            {showControls && total > 1 && (\n              <div className=\"ml-3 flex items-center gap-2\">\n                <button onClick={prev} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Prev</button>\n                <button onClick={next} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Next</button>\n              </div>\n            )}\n          </div>\n        </>\n      ) : (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white/70 text-sm\">Preparing player…</div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAce,SAAS,YAAY,KAMjB;QANiB,EAClC,OAAO,EACP,KAAK,EACL,OAAO,EACP,UAAU,IAAI,EACd,eAAe,IAAI,EACF,GANiB;;IAOlC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,qBAAkB,AAAD,EAAE;QAC5E,WAAW;QACX;QACA;QACA,cAAc;IAChB;IAEA,MAAM,cAAc,IAAO,UAAU,YAAY,OAAO,IAAI;IAE5D,qBACE,6LAAC;QAAI,WAAU;kBACZ,oBACC;;8BACE,6LAAC;oBAEC,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;oBACN,QAAQ;oBACR,SAAS;oBACT,OAAO;wBAAE,QAAQ;oBAAO;oBACxB,OAAO,SAAS,AAAC,SAAgB,OAAR;mBARpB;;;;;8BAYP,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;;;;;;wBAEtB,uBACC,6LAAC;4BAAG,WAAU;sCAAuD;;;;;;;;;;;;8BAKzE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAI;;;;;;sCACL,6LAAC;4BAAI,WAAU;;gCAAe;gCAAQ,QAAQ;gCAAE;gCAAE,SAAS;;;;;;;wBAC1D,gBAAgB,QAAQ,mBACvB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;8CACnF,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;;;;;;;;yCAM3F,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;;;;;AAKjD;GAlEwB;;QAOP,qIAAA,CAAA,YAAS;QACmC,qIAAA,CAAA,qBAAkB;;;KARvD","debugId":null}},
    {"offset": {"line": 1213, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/TvPlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useEmbedAutoSwitch } from '@/lib/hooks/useEmbedAutoSwitch';\n\ninterface TvPlayerProps {\n  mediaId: number;\n  season: number;\n  episode: number;\n  title?: string;\n  onClose?: () => void;\n  guardMs?: number;\n  showControls?: boolean;\n  autoNextMs?: number; // crude auto-next timer (optional)\n}\n\nexport default function TvPlayer({\n  mediaId,\n  season,\n  episode,\n  title,\n  onClose,\n  guardMs = 5000,\n  showControls = true,\n  autoNextMs,\n}: TvPlayerProps) {\n  const router = useRouter();\n  const { src, index, total, onLoad, onError, next, prev } = useEmbedAutoSwitch({\n    mediaType: 'tv',\n    mediaId,\n    season,\n    episode,\n    guardMs,\n    preferServer: true,\n  });\n\n  const handleClose = () => (onClose ? onClose() : router.back());\n\n  useEffect(() => {\n    if (!autoNextMs) return;\n    const id = window.setTimeout(() => {\n      const nextEp = (episode || 1) + 1;\n      router.replace(`/watch/tv/${mediaId}?season=${season}&episode=${nextEp}`, { scroll: false });\n    }, autoNextMs);\n    return () => clearTimeout(id);\n  }, [autoNextMs, episode, season, mediaId, router]);\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {src ? (\n        <>\n          <iframe\n            key={src}\n            src={src}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"autoplay; encrypted-media; picture-in-picture\"\n            onLoad={onLoad}\n            onError={onError}\n            style={{ border: 'none' }}\n            title={title || `tv-${mediaId}-s${season}e${episode}`}\n          />\n\n          {/* Back + Title + S/E */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 text-white\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg truncate max-w-xs\">{title}</h1>\n            )}\n            <div className=\"ml-2 text-white/80 text-sm px-2 py-0.5 rounded bg-black/50\">\n              S{season}E{episode}\n            </div>\n          </div>\n\n          <div className=\"absolute top-4 right-4 z-30 text-white/80 text-sm flex items-center gap-3\">\n            <div>Auto-switch enabled — Press ESC to exit</div>\n            <div className=\"text-xs ml-2\">Source {index + 1}/{total || 0}</div>\n            {showControls && total > 1 && (\n              <div className=\"ml-3 flex items-center gap-2\">\n                <button onClick={prev} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Prev</button>\n                <button onClick={next} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Next</button>\n              </div>\n            )}\n          </div>\n        </>\n      ) : (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white/70 text-sm\">Preparing player…</div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAkBe,SAAS,SAAS,KASjB;QATiB,EAC/B,OAAO,EACP,MAAM,EACN,OAAO,EACP,KAAK,EACL,OAAO,EACP,UAAU,IAAI,EACd,eAAe,IAAI,EACnB,UAAU,EACI,GATiB;;IAU/B,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,qBAAkB,AAAD,EAAE;QAC5E,WAAW;QACX;QACA;QACA;QACA;QACA,cAAc;IAChB;IAEA,MAAM,cAAc,IAAO,UAAU,YAAY,OAAO,IAAI;IAE5D,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,IAAI,CAAC,YAAY;YACjB,MAAM,KAAK,OAAO,UAAU;yCAAC;oBAC3B,MAAM,SAAS,CAAC,WAAW,CAAC,IAAI;oBAChC,OAAO,OAAO,CAAC,AAAC,aAA8B,OAAlB,SAAQ,YAA4B,OAAlB,QAAO,aAAkB,OAAP,SAAU;wBAAE,QAAQ;oBAAM;gBAC5F;wCAAG;YACH;sCAAO,IAAM,aAAa;;QAC5B;6BAAG;QAAC;QAAY;QAAS;QAAQ;QAAS;KAAO;IAEjD,qBACE,6LAAC;QAAI,WAAU;kBACZ,oBACC;;8BACE,6LAAC;oBAEC,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;oBACN,QAAQ;oBACR,SAAS;oBACT,OAAO;wBAAE,QAAQ;oBAAO;oBACxB,OAAO,SAAS,AAAC,MAAiB,OAAZ,SAAQ,MAAc,OAAV,QAAO,KAAW,OAAR;mBARvC;;;;;8BAYP,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;;;;;;wBAEtB,uBACC,6LAAC;4BAAG,WAAU;sCAAuD;;;;;;sCAEvE,6LAAC;4BAAI,WAAU;;gCAA6D;gCACxE;gCAAO;gCAAE;;;;;;;;;;;;;8BAIf,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAI;;;;;;sCACL,6LAAC;4BAAI,WAAU;;gCAAe;gCAAQ,QAAQ;gCAAE;gCAAE,SAAS;;;;;;;wBAC1D,gBAAgB,QAAQ,mBACvB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;8CACnF,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;;;;;;;;yCAM3F,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;;;;;AAKjD;GAlFwB;;QAUP,qIAAA,CAAA,YAAS;QACmC,qIAAA,CAAA,qBAAkB;;;KAXvD","debugId":null}},
    {"offset": {"line": 1425, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/app/watch/%5Bmediatype%5D/%5Bid%5D/page.tsx"],"sourcesContent":["// app/watch/[mediatype]/[id]/page.tsx\n'use client';\n\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport MoviePlayer from '@/components/players/MoviePlayer';\nimport TvPlayer from '@/components/players/TvPlayer';\nimport { tmdbApi } from '@/lib/api/tmdb';\n\nexport default function WatchPage() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [mediaData, setMediaData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  const mediaType = params?.mediatype as 'movie' | 'tv';\n  const id = parseInt(params?.id as string, 10);\n\n  // Get season and episode from query params for TV shows (default to 1)\n  const season = parseInt(searchParams.get('season') || '1', 10);\n  const episode = parseInt(searchParams.get('episode') || '1', 10);\n\n  useEffect(() => {\n    // Hide body scroll for fullscreen experience\n    const prevOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.body.style.overflow = prevOverflow || 'auto';\n    };\n  }, []);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    async function loadMediaData() {\n      setLoading(true);\n      try {\n        let data = null;\n        if (mediaType === 'movie') {\n          data = await tmdbApi.getMovieDetails(id);\n        } else if (mediaType === 'tv') {\n          data = await tmdbApi.getTVShowDetails(id);\n        }\n\n        if (!cancelled) setMediaData(data);\n      } catch (error) {\n        console.error('Failed to load media:', error);\n        if (!cancelled) setMediaData(null);\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n\n    if (id && (mediaType === 'movie' || mediaType === 'tv')) {\n      loadMediaData();\n    } else {\n      setLoading(false);\n    }\n\n    return () => { cancelled = true; };\n  }, [id, mediaType]);\n\n  const handleClose = () => {\n    router.back();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-2 border-white border-t-transparent mx-auto mb-4\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!mediaData && (mediaType === 'movie' || mediaType === 'tv')) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-xl font-semibold mb-4\">Media not found</h1>\n          <button\n            onClick={handleClose}\n            className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Determine a display title (movie.title or tv.name)\n  const title = mediaData?.title ?? mediaData?.name ?? '';\n\n  // Render correct player\n  if (mediaType === 'movie') {\n    return (\n      <MoviePlayer\n        mediaId={id}\n        title={title}\n        onClose={handleClose}\n        // optional tuning:\n        guardMs={6000}\n        showControls={true}\n      />\n    );\n  }\n\n  if (mediaType === 'tv') {\n    return (\n      <TvPlayer\n        mediaId={id}\n        season={season}\n        episode={episode}\n        title={title}\n        onClose={handleClose}\n        // optional tuning values — tweak as desired:\n        guardMs={5000}\n        autoNextMs={25 * 60 * 1000} // auto-advance after ~25 minutes (optional)\n        showControls={true}\n      />\n    );\n  }\n\n  // Fallback for unknown mediatype\n  return (\n    <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n      <div className=\"text-center\">\n        <h1 className=\"text-xl font-semibold mb-4\">Unsupported media type</h1>\n        <button\n          onClick={handleClose}\n          className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n        >\n          Go Back\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1659, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js","sources":["file:///home/flex/Atto4/node_modules/lucide-react/src/icons/arrow-left.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAC/C;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC3C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,SAAA,CAAA,CAAA,2KAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}