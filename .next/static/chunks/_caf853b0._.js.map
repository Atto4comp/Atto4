{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-common.ts"],"sourcesContent":["// lib/api/video-common.ts\n// Shared utilities, types and helpers for video APIs\n\nexport interface VideoSource {\n  url: string;\n  quality: string;\n  type: \"iframe\";\n  servers: string;\n  tmdbId: number;\n  mediaType: \"movie\" | \"tv\";\n  season?: number;\n  episode?: number;\n  title?: string;\n  episodeTitle?: string;\n  responseTime?: number;\n  working?: boolean;\n  error?: string;\n  provider?: string;\n}\n\nexport interface VideoProvider {\n  name: string;\n  value: string;\n  priority: number;\n  mediaTypes: (\"movie\" | \"tv\")[];\n  isTemplate: boolean;\n  hostname: string;\n}\n\nexport interface EmbedCheckResponse {\n  success: boolean;\n  workingUrl?: {\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n  };\n  totalTested: number;\n  workingCount: number;\n  allUrls: Array<{\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n    working: boolean;\n    responseTime?: number;\n    error?: string;\n  }>;\n  metadata: {\n    mediaType: string;\n    tmdbId: number;\n    season?: number;\n    episode?: number;\n    tested: boolean;\n    timestamp: string;\n  };\n}\n\n/** Read and normalize environment variables with validation */\nexport const ENV = {\n  BASE: (process.env.NEXT_PUBLIC_VIDEO_API_BASE || \"\").trim(),\n  E1: (process.env.NEXT_PUBLIC_VIDEO_EMBED_1 || \"https://cinemaos.tech/player/${id}?autoplay=true\").trim(),\n  E2: (process.env.NEXT_PUBLIC_VIDEO_EMBED_2 || \"https://cinemaos.tech/player/${id}/${season}/${episode}?autoplay=true&autonext=true\").trim(),\n  E3: (process.env.NEXT_PUBLIC_VIDEO_EMBED_3 || \"\").trim(),\n  E4: (process.env.NEXT_PUBLIC_VIDEO_EMBED_4 || \"\").trim(),\n  TMDB_API_KEY: (process.env.NEXT_PUBLIC_TMDB_API_KEY || \"\").trim(),\n};\n\n/** Global extra params appended to every embed URL */\nexport const EXTRA_PARAMS = (process.env.NEXT_PUBLIC_VIDEO_URL_PARAMS || \"\").trim();\n\n/** Enhanced providers list with media type support */\nexport const VIDEO_PROVIDERS: VideoProvider[] = [\n  { \n    name: \"Primary\", \n    value: ENV.E1, \n    priority: 1,\n    mediaTypes: [\"movie\", \"tv\"],\n    isTemplate: isTemplate(ENV.E1),\n    hostname: getServerLabel(ENV.E1)\n  },\n  { \n    name: \"Secondary\", \n    value: ENV.E2, \n    priority: 2,\n    mediaTypes: [\"movie\", \"tv\"],\n    isTemplate: isTemplate(ENV.E2),\n    hostname: getServerLabel(ENV.E2)\n  },\n  { \n    name: \"Tertiary\", \n    value: ENV.E3, \n    priority: 3,\n    mediaTypes: [\"movie\", \"tv\"],\n    isTemplate: isTemplate(ENV.E3),\n    hostname: getServerLabel(ENV.E3)\n  },\n  { \n    name: \"Backup\", \n    value: ENV.E4, \n    priority: 4,\n    mediaTypes: [\"movie\", \"tv\"],\n    isTemplate: isTemplate(ENV.E4),\n    hostname: getServerLabel(ENV.E4)\n  },\n  { \n    name: \"Base\", \n    value: ENV.BASE, \n    priority: 5,\n    mediaTypes: [\"movie\", \"tv\"],\n    isTemplate: isTemplate(ENV.BASE),\n    hostname: getServerLabel(ENV.BASE)\n  },\n].filter(p => !!p.value);\n\n/** Enhanced helper functions */\nexport function getServerLabel(url: string): string {\n  if (!url) return 'Unknown Server';\n  try {\n    const hostname = new URL(url).hostname;\n    return hostname.replace(/^www\\./, '');\n  } catch {\n    return 'Unknown Server';\n  }\n}\n\nexport function buildEmbedPath(\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): string {\n  if (!tmdbId || tmdbId <= 0) {\n    throw new Error(`Invalid TMDB ID: ${tmdbId}`);\n  }\n\n  if (mediaType === \"movie\") {\n    return `/movie/${tmdbId}`;\n  }\n  \n  if (mediaType === \"tv\") {\n    if (season && episode) {\n      return `/tv/${tmdbId}/${season}/${episode}`;\n    }\n    return `/tv/${tmdbId}`;\n  }\n  \n  throw new Error(`Invalid media type: ${mediaType}`);\n}\n\nexport function isTemplate(url: string): boolean {\n  if (!url) return false;\n  return /\\$\\{(id|type|season|episode)\\}/.test(url);\n}\n\nexport function normalizeBase(url: string): string {\n  if (!url) return '';\n  return url.endsWith(\"/\") ? url.slice(0, -1) : url;\n}\n\nexport function appendParams(url: string, params: string): string {\n  if (!params || !url) return url;\n  const separator = url.includes(\"?\") ? \"&\" : \"?\";\n  return `${url}${separator}${params}`;\n}\n\nexport function buildRawUrl(\n  providerValue: string,\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): string {\n  if (!providerValue) {\n    throw new Error('Provider value is required');\n  }\n\n  if (!tmdbId || tmdbId <= 0) {\n    throw new Error(`Invalid TMDB ID: ${tmdbId}`);\n  }\n\n  if (isTemplate(providerValue)) {\n    // Template mode: replace placeholders\n    return providerValue\n      .replace(/\\$\\{id\\}/g, String(tmdbId))\n      .replace(/\\$\\{type\\}/g, mediaType)\n      .replace(/\\$\\{season\\}/g, season ? String(season) : \"1\")\n      .replace(/\\$\\{episode\\}/g, episode ? String(episode) : \"1\");\n  }\n  \n  // Base mode: append canonical path\n  const base = normalizeBase(providerValue);\n  const path = buildEmbedPath(mediaType, tmdbId, season, episode);\n  return `${base}${path}`;\n}\n\nexport function buildEmbedUrl(\n  providerValue: string,\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): string {\n  try {\n    const raw = buildRawUrl(providerValue, mediaType, tmdbId, season, episode);\n    return appendParams(raw, EXTRA_PARAMS);\n  } catch (error) {\n    console.error('Failed to build embed URL:', error);\n    throw error;\n  }\n}\n\n/** Get providers filtered by media type */\nexport function getProvidersForMediaType(mediaType: \"movie\" | \"tv\"): VideoProvider[] {\n  return VIDEO_PROVIDERS.filter(provider => \n    provider.mediaTypes.includes(mediaType)\n  );\n}\n\n/** Get all embed URL candidates for a media type */\nexport function getEmbedUrlCandidates(\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): string[] {\n  const providers = getProvidersForMediaType(mediaType);\n  const urls = providers.map(provider =>\n    buildEmbedUrl(provider.value, mediaType, tmdbId, season, episode)\n  );\n  \n  // Remove duplicates while preserving order\n  return [...new Set(urls)];\n}\n\n/** Enhanced TMDB ID resolver with better error handling */\nimport axios from 'axios';\nexport async function resolveTmdbId(\n  input: string | number,\n  type: \"movie\" | \"tv\"\n): Promise<number | null> {\n  // Handle numeric input\n  if (typeof input === \"number\" && Number.isFinite(input) && input > 0) {\n    return input;\n  }\n\n  const str = String(input).trim();\n  if (!str) return null;\n\n  // Handle string numeric input\n  const asNum = Number(str);\n  if (Number.isFinite(asNum) && asNum > 0) {\n    return asNum;\n  }\n\n  // Handle IMDb IDs\n  if (/^tt\\d+$/i.test(str)) {\n    if (!ENV.TMDB_API_KEY) {\n      console.error('TMDB API key is required to resolve IMDb IDs');\n      return null;\n    }\n    \n    try {\n      const { data } = await axios.get(\n        `https://api.themoviedb.org/3/find/${str}`,\n        {\n          params: { \n            api_key: ENV.TMDB_API_KEY, \n            external_source: \"imdb_id\" \n          },\n          timeout: 5000\n        }\n      );\n      \n      const results = type === \"movie\" ? data.movie_results : data.tv_results;\n      const tmdbId = results?.[0]?.id;\n      \n      if (!tmdbId) {\n        console.warn(`No TMDB ${type} found for IMDb ID: ${str}`);\n        return null;\n      }\n      \n      return tmdbId;\n    } catch (error) {\n      console.error(`Failed to resolve IMDb ID ${str}:`, error);\n      return null;\n    }\n  }\n\n  console.warn(`Invalid input format for TMDB ID resolution: ${str}`);\n  return null;\n}\n\n/** Configuration validation */\nexport function validateConfiguration(): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Check if we have any providers\n  if (VIDEO_PROVIDERS.length === 0) {\n    errors.push('No video providers configured');\n  }\n\n  // Check for TMDB API key\n  if (!ENV.TMDB_API_KEY) {\n    warnings.push('TMDB API key not configured - IMDb ID resolution will not work');\n  }\n\n  // Validate provider URLs\n  VIDEO_PROVIDERS.forEach(provider => {\n    if (!provider.value) {\n      errors.push(`Provider \"${provider.name}\" has empty value`);\n      return;\n    }\n\n    // Check if template providers have required placeholders\n    if (isTemplate(provider.value)) {\n      if (!provider.value.includes('${id}')) {\n        errors.push(`Template provider \"${provider.name}\" missing \\${id} placeholder`);\n      }\n    } else {\n      // Check if base URL is valid\n      try {\n        new URL(provider.value);\n      } catch {\n        errors.push(`Provider \"${provider.name}\" has invalid base URL: ${provider.value}`);\n      }\n    }\n  });\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings\n  };\n}\n\n/** Debug helper to get configuration status */\nexport function getConfigurationStatus() {\n  const validation = validateConfiguration();\n  \n  return {\n    providers: {\n      total: VIDEO_PROVIDERS.length,\n      movie: getProvidersForMediaType('movie').length,\n      tv: getProvidersForMediaType('tv').length,\n      details: VIDEO_PROVIDERS.map(p => ({\n        name: p.name,\n        hostname: p.hostname,\n        isTemplate: p.isTemplate,\n        mediaTypes: p.mediaTypes,\n        priority: p.priority\n      }))\n    },\n    environment: {\n      tmdbApiKey: !!ENV.TMDB_API_KEY,\n      extraParams: EXTRA_PARAMS || 'none'\n    },\n    validation\n  };\n}\n\n/** Enhanced API call to check embed URLs (client-side convenience) */\nexport async function checkEmbedUrls(\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number,\n  testUrls: boolean = true\n): Promise<EmbedCheckResponse | null> {\n  try {\n    const response = await fetch('/api/check-embed', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        mediaType,\n        tmdbId,\n        season,\n        episode,\n        testUrls\n      })\n    });\n\n    if (!response.ok) {\n      console.error(`Embed check API failed: ${response.status} ${response.statusText}`);\n      return null;\n    }\n\n    const data: EmbedCheckResponse = await response.json();\n    return data;\n  } catch (error) {\n    console.error('Failed to check embed URLs:', error);\n    return null;\n  }\n}\n\n/** Create VideoSource from provider */\nexport function createVideoSource(\n  provider: VideoProvider,\n  mediaType: \"movie\" | \"tv\",\n  tmdbId: number,\n  season?: number,\n  episode?: number,\n  additionalData?: Partial<VideoSource>\n): VideoSource {\n  const url = buildEmbedUrl(provider.value, mediaType, tmdbId, season, episode);\n  \n  return {\n    url,\n    quality: \"HD\",\n    type: \"iframe\",\n    servers: `${provider.name} (${provider.hostname})`,\n    tmdbId,\n    mediaType,\n    season,\n    episode,\n    provider: provider.name,\n    ...additionalData\n  };\n}\n\n/** Log configuration for debugging */\nexport function logConfiguration(): void {\n  const status = getConfigurationStatus();\n  console.group('üé¨ Video Configuration Status');\n  console.log('Providers:', status.providers);\n  console.log('Environment:', status.environment);\n  \n  if (status.validation.errors.length > 0) {\n    console.error('Errors:', status.validation.errors);\n  }\n  \n  if (status.validation.warnings.length > 0) {\n    console.warn('Warnings:', status.validation.warnings);\n  }\n  \n  console.groupEnd();\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 340, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-movie.ts"],"sourcesContent":["// lib/api/video-movie.ts\nimport {\n  type VideoSource,\n  type VideoProvider,\n  type EmbedCheckResponse,\n  getProvidersForMediaType,\n  createVideoSource,\n  resolveTmdbId,\n  checkEmbedUrls,\n  getEmbedUrlCandidates,\n  ENV,\n  validateConfiguration,\n  getServerLabel\n} from './video-common';\nimport axios from 'axios';\n\n/** Movie-specific video API */\n\n/** Get all movie-compatible providers */\nfunction getMovieProviders(): VideoProvider[] {\n  return getProvidersForMediaType('movie');\n}\n\n/** Enhanced movie sources with validation */\nexport async function getMovieSources(tmdbId: number): Promise<VideoSource[]> {\n  if (!tmdbId || tmdbId <= 0) {\n    throw new Error(`Invalid movie TMDB ID: ${tmdbId}`);\n  }\n\n  const config = validateConfiguration();\n  if (!config.isValid) {\n    console.error('Video configuration errors:', config.errors);\n    throw new Error('Invalid video configuration');\n  }\n\n  const providers = getMovieProviders();\n  if (providers.length === 0) {\n    console.warn('No movie-compatible providers configured');\n    return [];\n  }\n\n  try {\n    // create sources but ensure servers label is consistent and helpful\n    const sources = providers.map(provider => {\n      const src = createVideoSource(provider, \"movie\", tmdbId, undefined, undefined, {\n        title: `Movie ${tmdbId}`\n      });\n\n      // normalize servers label: \"Primary (example.com)\"\n      const hostname = provider.hostname || getServerLabel(provider.value || '');\n      src.servers = `${provider.name} (${hostname})`;\n      src.provider = provider.name;\n      return src;\n    });\n\n    console.log(`üìΩÔ∏è Generated ${sources.length} movie sources for TMDB ID: ${tmdbId}`);\n    return sources;\n  } catch (error) {\n    console.error(`Failed to generate movie sources for TMDB ID ${tmdbId}:`, error);\n    throw error;\n  }\n}\n\n/* rest of file unchanged ‚Äî keep existing getMovieSourcesWithTesting, getMovieWithEmbed, etc. */\n/* ... You can retain the rest of your movie file as-is (no behavioral change) ... */\n\nexport async function getMovieSourcesWithTesting(\n  tmdbId: number,\n  testUrls: boolean = true\n): Promise<{\n  sources: VideoSource[];\n  workingSources: VideoSource[];\n  embedCheckData: EmbedCheckResponse | null;\n}> {\n  // (copy your existing implementation here ‚Äî unchanged)\n  const sources = await getMovieSources(tmdbId);\n\n  if (!testUrls) {\n    return {\n      sources,\n      workingSources: sources,\n      embedCheckData: null\n    };\n  }\n\n  const embedCheckData = await checkEmbedUrls('movie', tmdbId);\n  \n  if (!embedCheckData) {\n    console.warn(`Failed to test movie sources for TMDB ID: ${tmdbId}`);\n    return {\n      sources,\n      workingSources: sources,\n      embedCheckData: null\n    };\n  }\n\n  const workingSources = embedCheckData.allUrls\n    .filter(url => url.working)\n    .map(url => {\n      const originalSource = sources.find(s => s.url === url.originalUrl) || sources[0];\n      return {\n        ...originalSource,\n        url: url.url,\n        working: url.working,\n        responseTime: url.responseTime,\n        error: url.error,\n        provider: url.provider,\n        servers: `${url.provider} (${url.working ? 'Working' : 'Failed'})`\n      };\n    });\n\n  console.log(`üé¨ Movie sources tested: ${workingSources.length}/${sources.length} working`);\n\n  return {\n    sources,\n    workingSources,\n    embedCheckData\n  };\n}\n\n// ... keep the rest unchanged (getMovieWithEmbed etc.) ...\n\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;AACzB;;AAeA,6BAA6B,GAE7B,uCAAuC,GACvC,SAAS;IACP,OAAO,CAAA,GAAA,gIAAA,CAAA,2BAAwB,AAAD,EAAE;AAClC;AAGO,eAAe,gBAAgB,MAAc;IAClD,IAAI,CAAC,UAAU,UAAU,GAAG;QAC1B,MAAM,IAAI,MAAM,AAAC,0BAAgC,OAAP;IAC5C;IAEA,MAAM,SAAS,CAAA,GAAA,gIAAA,CAAA,wBAAqB,AAAD;IACnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,QAAQ,KAAK,CAAC,+BAA+B,OAAO,MAAM;QAC1D,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,YAAY;IAClB,IAAI,UAAU,MAAM,KAAK,GAAG;QAC1B,QAAQ,IAAI,CAAC;QACb,OAAO,EAAE;IACX;IAEA,IAAI;QACF,oEAAoE;QACpE,MAAM,UAAU,UAAU,GAAG,CAAC,CAAA;YAC5B,MAAM,MAAM,CAAA,GAAA,gIAAA,CAAA,oBAAiB,AAAD,EAAE,UAAU,SAAS,QAAQ,WAAW,WAAW;gBAC7E,OAAO,AAAC,SAAe,OAAP;YAClB;YAEA,mDAAmD;YACnD,MAAM,WAAW,SAAS,QAAQ,IAAI,CAAA,GAAA,gIAAA,CAAA,iBAAc,AAAD,EAAE,SAAS,KAAK,IAAI;YACvE,IAAI,OAAO,GAAG,AAAC,GAAoB,OAAlB,SAAS,IAAI,EAAC,MAAa,OAAT,UAAS;YAC5C,IAAI,QAAQ,GAAG,SAAS,IAAI;YAC5B,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,AAAC,iBAA6D,OAA7C,QAAQ,MAAM,EAAC,gCAAqC,OAAP;QAC1E,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,AAAC,gDAAsD,OAAP,QAAO,MAAI;QACzE,MAAM;IACR;AACF;AAKO,eAAe,2BACpB,MAAc;QACd,WAAA,iEAAoB;IAMpB,uDAAuD;IACvD,MAAM,UAAU,MAAM,gBAAgB;IAEtC,IAAI,CAAC,UAAU;QACb,OAAO;YACL;YACA,gBAAgB;YAChB,gBAAgB;QAClB;IACF;IAEA,MAAM,iBAAiB,MAAM,CAAA,GAAA,gIAAA,CAAA,iBAAc,AAAD,EAAE,SAAS;IAErD,IAAI,CAAC,gBAAgB;QACnB,QAAQ,IAAI,CAAC,AAAC,6CAAmD,OAAP;QAC1D,OAAO;YACL;YACA,gBAAgB;YAChB,gBAAgB;QAClB;IACF;IAEA,MAAM,iBAAiB,eAAe,OAAO,CAC1C,MAAM,CAAC,CAAA,MAAO,IAAI,OAAO,EACzB,GAAG,CAAC,CAAA;QACH,MAAM,iBAAiB,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,GAAG,KAAK,IAAI,WAAW,KAAK,OAAO,CAAC,EAAE;QACjF,OAAO;YACL,GAAG,cAAc;YACjB,KAAK,IAAI,GAAG;YACZ,SAAS,IAAI,OAAO;YACpB,cAAc,IAAI,YAAY;YAC9B,OAAO,IAAI,KAAK;YAChB,UAAU,IAAI,QAAQ;YACtB,SAAS,AAAC,GAAmB,OAAjB,IAAI,QAAQ,EAAC,MAAuC,OAAnC,IAAI,OAAO,GAAG,YAAY,UAAS;QAClE;IACF;IAEF,QAAQ,GAAG,CAAC,AAAC,4BAAoD,OAAzB,eAAe,MAAM,EAAC,KAAkB,OAAf,QAAQ,MAAM,EAAC;IAEhF,OAAO;QACL;QACA;QACA;IACF;AACF,EAEA,2DAA2D","debugId":null}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-tv.ts"],"sourcesContent":["// lib/api/video-tv.ts\nimport {\n  type VideoSource,\n  type VideoProvider,\n  type EmbedCheckResponse,\n  getProvidersForMediaType,\n  createVideoSource,\n  resolveTmdbId,\n  checkEmbedUrls,\n  getEmbedUrlCandidates,\n  ENV,\n  validateConfiguration\n} from './video-common';\nimport axios from 'axios';\n\n/** TV-specific video API */\n\n/** Get all TV-compatible providers */\nfunction getTVProviders(): VideoProvider[] {\n  return getProvidersForMediaType('tv');\n}\n\n/** Enhanced TV sources with validation */\nexport async function getTVSources(\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): Promise<VideoSource[]> {\n  if (!tmdbId || tmdbId <= 0) {\n    throw new Error(`Invalid TV show TMDB ID: ${tmdbId}`);\n  }\n\n  const seasonNum = season || 1;\n  const episodeNum = episode || 1;\n\n  if (seasonNum <= 0 || episodeNum <= 0) {\n    throw new Error(`Invalid season/episode: S${seasonNum}E${episodeNum}`);\n  }\n\n  const config = validateConfiguration();\n  if (!config.isValid) {\n    console.error('Video configuration errors:', config.errors);\n    throw new Error('Invalid video configuration');\n  }\n\n  const providers = getTVProviders();\n  if (providers.length === 0) {\n    console.warn('No TV-compatible providers configured');\n    return [];\n  }\n\n  try {\n    const sources = providers.map(provider => \n      createVideoSource(provider, \"tv\", tmdbId, seasonNum, episodeNum, {\n        title: `TV Show ${tmdbId}`,\n        episodeTitle: `S${seasonNum}E${episodeNum}`\n      })\n    );\n\n    console.log(`üì∫ Generated ${sources.length} TV sources for TMDB ID: ${tmdbId} S${seasonNum}E${episodeNum}`);\n    return sources;\n  } catch (error) {\n    console.error(`Failed to generate TV sources for TMDB ID ${tmdbId} S${seasonNum}E${episodeNum}:`, error);\n    throw error;\n  }\n}\n\nexport async function getTVSourcesWithTesting(\n  tmdbId: number,\n  season?: number,\n  episode?: number,\n  testUrls: boolean = true\n): Promise<{\n  sources: VideoSource[];\n  workingSources: VideoSource[];\n  embedCheckData: EmbedCheckResponse | null;\n}> {\n  const seasonNum = season || 1;\n  const episodeNum = episode || 1;\n\n  const sources = await getTVSources(tmdbId, seasonNum, episodeNum);\n\n  if (!testUrls) {\n    return { sources, workingSources: sources, embedCheckData: null };\n  }\n\n  const embedCheckData = await checkEmbedUrls('tv', tmdbId, seasonNum, episodeNum);\n  \n  if (!embedCheckData) {\n    console.warn(`Failed to test TV sources for TMDB ID: ${tmdbId} S${seasonNum}E${episodeNum}`);\n    return { sources, workingSources: sources, embedCheckData: null };\n  }\n\n  const workingSources = embedCheckData.allUrls\n    .filter(url => url.working)\n    .map(url => {\n      const originalSource = sources.find(s => s.url === url.originalUrl) || sources[0];\n      return {\n        ...originalSource,\n        url: url.url,\n        working: url.working,\n        responseTime: url.responseTime,\n        error: url.error,\n        provider: url.provider,\n        servers: `${url.provider} (${url.working ? 'Working' : 'Failed'})`\n      };\n    });\n\n  console.log(`üì∫ TV sources tested: ${workingSources.length}/${sources.length} working for S${seasonNum}E${episodeNum}`);\n\n  return { sources, workingSources, embedCheckData };\n}\n\nexport async function getTVEpisodeInfo(\n  tmdbId: number,\n  season: number,\n  episode: number\n): Promise<{\n  episode: any;\n  season: any;\n  show: any;\n} | null> {\n  if (!ENV.TMDB_API_KEY) {\n    console.warn('TMDB API key not available for episode info');\n    return null;\n  }\n\n  try {\n    const [episodeResponse, seasonResponse, showResponse] = await Promise.all([\n      axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}/season/${season}/episode/${episode}`, {\n        params: { api_key: ENV.TMDB_API_KEY },\n        timeout: 8000\n      }).catch(() => ({ data: null })),\n      \n      axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}/season/${season}`, {\n        params: { api_key: ENV.TMDB_API_KEY },\n        timeout: 8000\n      }).catch(() => ({ data: null })),\n      \n      axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}`, {\n        params: { api_key: ENV.TMDB_API_KEY },\n        timeout: 8000\n      }).catch(() => ({ data: null }))\n    ]);\n\n    return {\n      episode: episodeResponse.data,\n      season: seasonResponse.data,\n      show: showResponse.data\n    };\n  } catch (error) {\n    console.error(`Failed to fetch TV episode info for ${tmdbId} S${season}E${episode}:`, error);\n    return null;\n  }\n}\n\nexport async function getTVShowWithEmbed(\n  tmdbId: number,\n  season?: number,\n  episode?: number,\n  testUrls: boolean = true\n) {\n  const seasonNum = season || 1;\n  const episodeNum = episode || 1;\n\n  const resolvedTmdbId = await resolveTmdbId(tmdbId, 'tv');\n  if (!resolvedTmdbId) {\n    throw new Error(`Invalid or unresolvable TV show TMDB ID: ${tmdbId}`);\n  }\n\n  try {\n    const [tvInfo, sourcesData] = await Promise.all([\n      ENV.TMDB_API_KEY ? getTVEpisodeInfo(resolvedTmdbId, seasonNum, episodeNum) : Promise.resolve(null),\n      getTVSourcesWithTesting(resolvedTmdbId, seasonNum, episodeNum, testUrls)\n    ]);\n\n    const { sources, workingSources, embedCheckData } = sourcesData;\n\n    if (tvInfo?.show?.name || tvInfo?.episode?.name) {\n      const showTitle = tvInfo.show?.name;\n      const episodeTitle = tvInfo.episode?.name;\n      sources.forEach(source => {\n        source.title = showTitle;\n        source.episodeTitle = episodeTitle || `S${seasonNum}E${episodeNum}`;\n      });\n      workingSources.forEach(source => {\n        source.title = showTitle;\n        source.episodeTitle = episodeTitle || `S${seasonNum}E${episodeNum}`;\n      });\n    }\n\n    const primaryEmbedUrl = workingSources[0]?.url || sources[0]?.url || \"\";\n\n    const result = {\n      tvShow: tvInfo?.show,\n      episode: tvInfo?.episode,\n      season: tvInfo?.season,\n      embedUrl: primaryEmbedUrl,\n      sources,\n      workingSources,\n      embedCheckData,\n      metadata: {\n        tmdbId: resolvedTmdbId,\n        mediaType: 'tv' as const,\n        season: seasonNum,\n        episode: episodeNum,\n        title: tvInfo?.show?.name,\n        episodeTitle: tvInfo?.episode?.name,\n        airDate: tvInfo?.episode?.air_date,\n        runtime: tvInfo?.episode?.runtime,\n        sourcesAvailable: sources.length,\n        workingSourcesCount: workingSources.length,\n        tested: testUrls,\n        timestamp: new Date().toISOString()\n      }\n    };\n\n    console.log(`üì∫ TV data prepared:`, {\n      title: tvInfo?.show?.name || `TV Show ${resolvedTmdbId}`,\n      episode: `S${seasonNum}E${episodeNum}`,\n      episodeTitle: tvInfo?.episode?.name,\n      sources: sources.length,\n      working: workingSources.length,\n      primaryUrl: !!primaryEmbedUrl\n    });\n\n    return result;\n  } catch (error) {\n    console.error(`Error fetching TV show with embed for TMDB ID ${resolvedTmdbId} S${seasonNum}E${episodeNum}:`, error);\n    return {\n      tvShow: null,\n      episode: null,\n      season: null,\n      embedUrl: \"\",\n      sources: [],\n      workingSources: [],\n      embedCheckData: null,\n      metadata: {\n        tmdbId: resolvedTmdbId,\n        mediaType: 'tv' as const,\n        season: seasonNum,\n        episode: episodeNum,\n        title: undefined,\n        episodeTitle: undefined,\n        airDate: undefined,\n        runtime: undefined,\n        sourcesAvailable: 0,\n        workingSourcesCount: 0,\n        tested: testUrls,\n        timestamp: new Date().toISOString(),\n        error: error instanceof Error ? error.message : 'Unknown error'\n      }\n    };\n  }\n}\n\nexport function getTVEmbedCandidates(\n  tmdbId: number,\n  season?: number,\n  episode?: number\n): string[] {\n  if (!tmdbId || tmdbId <= 0) {\n    throw new Error(`Invalid TV show TMDB ID: ${tmdbId}`);\n  }\n\n  const seasonNum = season || 1;\n  const episodeNum = episode || 1;\n  return getEmbedUrlCandidates('tv', tmdbId, seasonNum, episodeNum);\n}\n\nexport async function getSeasonEpisodes(\n  tmdbId: number,\n  season: number\n): Promise<any[] | null> {\n  if (!ENV.TMDB_API_KEY) {\n    console.warn('TMDB API key not available for season episodes');\n    return null;\n  }\n\n  try {\n    const response = await axios.get(`https://api.themoviedb.org/3/tv/${tmdbId}/season/${season}`, {\n      params: { api_key: ENV.TMDB_API_KEY },\n      timeout: 10000\n    });\n\n    return response.data?.episodes || [];\n  } catch (error) {\n    console.error(`Failed to fetch season ${season} episodes for TV show ${tmdbId}:`, error);\n    return null;\n  }\n}\n\nexport async function getAdjacentEpisodes(\n  tmdbId: number,\n  currentSeason: number,\n  currentEpisode: number\n): Promise<{\n  nextEpisode: { season: number; episode: number } | null;\n  previousEpisode: { season: number; episode: number } | null;\n}> {\n  const episodes = await getSeasonEpisodes(tmdbId, currentSeason);\n  \n  let nextEpisode = null;\n  let previousEpisode = null;\n\n  if (episodes) {\n    if (currentEpisode < episodes.length) {\n      nextEpisode = { season: currentSeason, episode: currentEpisode + 1 };\n    }\n    if (currentEpisode > 1) {\n      previousEpisode = { season: currentSeason, episode: currentEpisode - 1 };\n    }\n  }\n\n  return { nextEpisode, previousEpisode };\n}\n\nexport function hasTVSourcesConfigured(): boolean {\n  return getTVProviders().length > 0;\n}\n\nexport function getTVConfigStatus() {\n  const providers = getTVProviders();\n  const validation = validateConfiguration();\n\n  return {\n    available: providers.length > 0,\n    providers: providers.map(p => ({\n      name: p.name,\n      hostname: p.hostname,\n      isTemplate: p.isTemplate,\n      priority: p.priority\n    })),\n    totalProviders: providers.length,\n    validation: validation,\n    tmdbApiAvailable: !!ENV.TMDB_API_KEY\n  };\n}\n\nexport function debugTVApi(tmdbId?: number, season?: number, episode?: number): void {\n  console.group('üì∫ TV Video API Debug');\n  const config = getTVConfigStatus();\n  console.log('Configuration:', config);\n\n  if (tmdbId) {\n    try {\n      const candidates = getTVEmbedCandidates(tmdbId, season, episode);\n      console.log(`Embed URL candidates for TV ${tmdbId} S${season || 1}E${episode || 1}:`, candidates);\n    } catch (error) {\n      console.error('Failed to generate candidates:', error);\n    }\n  }\n\n  console.groupEnd();\n}\n\nexport { resolveTmdbId as resolveTVTmdbId };\n\nexport const tvVideoApi = {\n  getTVSources,\n  getTVSourcesWithTesting,\n  getTVShowWithEmbed,\n  getTVEmbedCandidates,\n  getTVEpisodeInfo,\n  getSeasonEpisodes,\n  getAdjacentEpisodes,\n  hasTVSourcesConfigured,\n  getTVConfigStatus,\n  debugTVApi,\n  resolveTVTmdbId\n};\n\nexport default tvVideoApi;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 794, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/hooks/useEmbedAutoSwitch.ts"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { getMovieSources, getTVSources } from '@/lib/api/video-api';\n\ntype MediaType = 'movie' | 'tv';\n\ntype ServerResult =\n  | string\n  | { url: string; working?: boolean; responseTimeMs?: number; status?: number; probe?: 'HEAD'|'GET' };\n\ninterface UseEmbedAutoSwitchArgs {\n  mediaType: MediaType;\n  mediaId: number;\n  season?: number;\n  episode?: number;\n  guardMs?: number;          // iframe load guard (auto switch) ‚Äî default 6000\n  preferServer?: boolean;    // use /api/check-embed first ‚Äî default true\n}\n\nexport function useEmbedAutoSwitch({\n  mediaType,\n  mediaId,\n  season,\n  episode,\n  guardMs = 6000,\n  preferServer = true,\n}: UseEmbedAutoSwitchArgs) {\n  const [candidates, setCandidates] = useState<string[]>([]);\n  const [index, setIndex] = useState(0);\n  const [src, setSrc] = useState<string>('');\n  const failed = useRef<Set<number>>(new Set());\n  const timer = useRef<number | null>(null);\n  const attemptId = useRef(0);\n  const mounted = useRef(true);\n\n  const clearGuard = useCallback(() => {\n    if (timer.current != null) {\n      window.clearTimeout(timer.current);\n      timer.current = null;\n    }\n  }, []);\n\n  const startGuard = useCallback((i: number) => {\n    clearGuard();\n    const thisAttempt = ++attemptId.current;\n    timer.current = window.setTimeout(() => {\n      // if still same attempt and not loaded ‚Äî mark failed & next\n      if (attemptId.current === thisAttempt) {\n        failed.current.add(i);\n        // try next\n        let next = -1;\n        for (let step = 1; step <= candidates.length; step++) {\n          const cand = (i + step) % candidates.length;\n          if (!failed.current.has(cand)) { next = cand; break; }\n        }\n        if (next >= 0) {\n          setIndex(next);\n          setSrc(candidates[next]);\n          startGuard(next);\n        }\n      }\n    }, guardMs) as unknown as number;\n  }, [candidates, guardMs, clearGuard]);\n\n  // load candidate list\n  useEffect(() => {\n    mounted.current = true;\n    failed.current.clear();\n    setCandidates([]);\n    setIndex(0);\n    setSrc('');\n\n    (async () => {\n      let list: string[] = [];\n\n      // 1) server-probed list\n      if (preferServer) {\n        try {\n          const res = await fetch('/api/check-embed', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n              mediaType,\n              tmdbId: mediaId,\n              season: season || 1,\n              episode: episode || 1,\n              timeoutMs: 4000,\n              retries: 0,\n            }),\n          });\n\n          if (res.ok) {\n            const data = await res.json();\n            // Accept either plain string array or array of objects\n            const urls: ServerResult[] = Array.isArray(data.urls) ? data.urls : [];\n            const normalized = urls.map(u => (typeof u === 'string' ? u : u?.url)).filter(Boolean) as string[];\n            // Put workingUrl first if present and not already at front\n            const first = typeof data.workingUrl === 'string' ? data.workingUrl : (data.workingUrl?.url ?? null);\n            if (first) {\n              list = [first, ...normalized.filter(u => u !== first)];\n            } else {\n              list = normalized;\n            }\n          }\n        } catch {\n          // ignore; fallback below\n        }\n      }\n\n      // 2) fallback to local providers if needed\n      if (list.length === 0) {\n        const fallback = mediaType === 'movie'\n          ? await getMovieSources(mediaId)\n          : await getTVSources(mediaId, season || 1, episode || 1);\n        list = (fallback || []).map(s => s.url).filter(Boolean);\n      }\n\n      list = Array.from(new Set(list)); // unique in order\n\n      if (!mounted.current) return;\n\n      setCandidates(list);\n      if (list.length > 0) {\n        setIndex(0);\n        setSrc(list[0]);\n        startGuard(0);\n      }\n    })();\n\n    return () => {\n      mounted.current = false;\n      clearGuard();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [mediaId, mediaType, season, episode, preferServer, guardMs]);\n\n  const onLoad = useCallback(() => {\n    clearGuard();\n    // current index succeeded; clear failure flag\n    failed.current.delete(index);\n  }, [index, clearGuard]);\n\n  const onError = useCallback(() => {\n    clearGuard();\n    failed.current.add(index);\n    // pick next\n    let next = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index + step) % candidates.length;\n      if (!failed.current.has(cand)) { next = cand; break; }\n    }\n    if (next >= 0) {\n      setIndex(next);\n      setSrc(candidates[next]);\n      startGuard(next);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  // optional manual controls\n  const next = useCallback(() => {\n    clearGuard();\n    let nextIdx = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index + step) % candidates.length;\n      if (!failed.current.has(cand)) { nextIdx = cand; break; }\n    }\n    if (nextIdx >= 0) {\n      setIndex(nextIdx);\n      setSrc(candidates[nextIdx]);\n      startGuard(nextIdx);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  const prev = useCallback(() => {\n    clearGuard();\n    let prevIdx = -1;\n    for (let step = 1; step <= candidates.length; step++) {\n      const cand = (index - step + candidates.length) % candidates.length;\n      if (!failed.current.has(cand)) { prevIdx = cand; break; }\n    }\n    if (prevIdx >= 0) {\n      setIndex(prevIdx);\n      setSrc(candidates[prevIdx]);\n      startGuard(prevIdx);\n    }\n  }, [index, candidates, clearGuard, startGuard]);\n\n  return {\n    src,\n    index,\n    total: candidates.length,\n    onLoad,\n    onError,\n    next,\n    prev,\n    setIndex, // if you want to jump\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1045, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/MoviePlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useEmbedAutoSwitch } from '@/lib/hooks/useEmbedAutoSwitch';\n\ninterface MoviePlayerProps {\n  mediaId: number;\n  title?: string;\n  onClose?: () => void;\n  guardMs?: number;\n  showControls?: boolean;\n}\n\nexport default function MoviePlayer({\n  mediaId,\n  title,\n  onClose,\n  guardMs = 6000,\n  showControls = true,\n}: MoviePlayerProps) {\n  const router = useRouter();\n  const { src, index, total, onLoad, onError, next, prev } = useEmbedAutoSwitch({\n    mediaType: 'movie',\n    mediaId,\n    guardMs,\n    preferServer: true,\n  });\n\n  const handleClose = () => (onClose ? onClose() : router.back());\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {src ? (\n        <>\n          <iframe\n            key={src}\n            src={src}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"autoplay; encrypted-media; picture-in-picture\"\n            onLoad={onLoad}\n            onError={onError}\n            style={{ border: 'none' }}\n            title={title || `movie-${mediaId}`}\n          />\n\n          {/* Back + Title */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 text-white\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg truncate max-w-xs\">{title}</h1>\n            )}\n          </div>\n\n          {/* Minimal overlay */}\n          <div className=\"absolute top-4 right-4 z-30 text-white/80 text-sm flex items-center gap-3\">\n            <div>Auto-switch enabled ‚Äî Press ESC to exit</div>\n            <div className=\"text-xs ml-2\">Source {index + 1}/{total || 0}</div>\n            {showControls && total > 1 && (\n              <div className=\"ml-3 flex items-center gap-2\">\n                <button onClick={prev} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Prev</button>\n                <button onClick={next} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Next</button>\n              </div>\n            )}\n          </div>\n        </>\n      ) : (\n        // No spinner per your request; just a quiet blank + small hint\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white/70 text-sm\">\n            Preparing player‚Ä¶\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAce,SAAS,YAAY,KAMjB;QANiB,EAClC,OAAO,EACP,KAAK,EACL,OAAO,EACP,UAAU,IAAI,EACd,eAAe,IAAI,EACF,GANiB;;IAOlC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,qBAAkB,AAAD,EAAE;QAC5E,WAAW;QACX;QACA;QACA,cAAc;IAChB;IAEA,MAAM,cAAc,IAAO,UAAU,YAAY,OAAO,IAAI;IAE5D,qBACE,6LAAC;QAAI,WAAU;kBACZ,oBACC;;8BACE,6LAAC;oBAEC,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;oBACN,QAAQ;oBACR,SAAS;oBACT,OAAO;wBAAE,QAAQ;oBAAO;oBACxB,OAAO,SAAS,AAAC,SAAgB,OAAR;mBARpB;;;;;8BAYP,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;;;;;;wBAEtB,uBACC,6LAAC;4BAAG,WAAU;sCAAuD;;;;;;;;;;;;8BAKzE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAI;;;;;;sCACL,6LAAC;4BAAI,WAAU;;gCAAe;gCAAQ,QAAQ;gCAAE;gCAAE,SAAS;;;;;;;wBAC1D,gBAAgB,QAAQ,mBACvB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;8CACnF,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;;;;;;;;2BAM3F,+DAA+D;sBAC/D,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;;;;;AAOjD;GArEwB;;QAOP,qIAAA,CAAA,YAAS;QACmC,qIAAA,CAAA,qBAAkB;;;KARvD","debugId":null}},
    {"offset": {"line": 1219, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/TvPlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useEmbedAutoSwitch } from '@/lib/hooks/useEmbedAutoSwitch';\n\ninterface TvPlayerProps {\n  mediaId: number;\n  season: number;\n  episode: number;\n  title?: string;\n  onClose?: () => void;\n  guardMs?: number;\n  showControls?: boolean;\n  autoNextMs?: number; // crude auto-next timer (optional)\n}\n\nexport default function TvPlayer({\n  mediaId,\n  season,\n  episode,\n  title,\n  onClose,\n  guardMs = 5000,      // be a bit more aggressive on TV\n  showControls = true,\n  autoNextMs,          // e.g., 25 * 60 * 1000\n}: TvPlayerProps) {\n  const router = useRouter();\n  const { src, index, total, onLoad, onError, next, prev } = useEmbedAutoSwitch({\n    mediaType: 'tv',\n    mediaId,\n    season,\n    episode,\n    guardMs,\n    preferServer: true,\n  });\n\n  const handleClose = () => (onClose ? onClose() : router.back());\n\n  // optional naive auto-next timer\n  useEffect(() => {\n    if (!autoNextMs) return;\n    const id = window.setTimeout(() => {\n      const nextEp = (episode || 1) + 1;\n      router.replace(`/watch/tv/${mediaId}?season=${season}&episode=${nextEp}`, { scroll: false });\n    }, autoNextMs);\n    return () => clearTimeout(id);\n  }, [autoNextMs, episode, season, mediaId, router]);\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {src ? (\n        <>\n          <iframe\n            key={src}\n            src={src}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"autoplay; encrypted-media; picture-in-picture\"\n            onLoad={onLoad}\n            onError={onError}\n            style={{ border: 'none' }}\n            title={title || `tv-${mediaId}-s${season}e${episode}`}\n          />\n\n          {/* Back + Title + S/E */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 text-white\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg truncate max-w-xs\">{title}</h1>\n            )}\n            <div className=\"ml-2 text-white/80 text-sm px-2 py-0.5 rounded bg-black/50\">\n              S{season}E{episode}\n            </div>\n          </div>\n\n          <div className=\"absolute top-4 right-4 z-30 text-white/80 text-sm flex items-center gap-3\">\n            <div>Auto-switch enabled ‚Äî Press ESC to exit</div>\n            <div className=\"text-xs ml-2\">Source {index + 1}/{total || 0}</div>\n            {showControls && total > 1 && (\n              <div className=\"ml-3 flex items-center gap-2\">\n                <button onClick={prev} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Prev</button>\n                <button onClick={next} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Next</button>\n              </div>\n            )}\n          </div>\n        </>\n      ) : (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white/70 text-sm\">\n            Preparing player‚Ä¶\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAkBe,SAAS,SAAS,KASjB;QATiB,EAC/B,OAAO,EACP,MAAM,EACN,OAAO,EACP,KAAK,EACL,OAAO,EACP,UAAU,IAAI,EACd,eAAe,IAAI,EACnB,UAAU,EACI,GATiB;;IAU/B,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,qBAAkB,AAAD,EAAE;QAC5E,WAAW;QACX;QACA;QACA;QACA;QACA,cAAc;IAChB;IAEA,MAAM,cAAc,IAAO,UAAU,YAAY,OAAO,IAAI;IAE5D,iCAAiC;IACjC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,IAAI,CAAC,YAAY;YACjB,MAAM,KAAK,OAAO,UAAU;yCAAC;oBAC3B,MAAM,SAAS,CAAC,WAAW,CAAC,IAAI;oBAChC,OAAO,OAAO,CAAC,AAAC,aAA8B,OAAlB,SAAQ,YAA4B,OAAlB,QAAO,aAAkB,OAAP,SAAU;wBAAE,QAAQ;oBAAM;gBAC5F;wCAAG;YACH;sCAAO,IAAM,aAAa;;QAC5B;6BAAG;QAAC;QAAY;QAAS;QAAQ;QAAS;KAAO;IAEjD,qBACE,6LAAC;QAAI,WAAU;kBACZ,oBACC;;8BACE,6LAAC;oBAEC,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;oBACN,QAAQ;oBACR,SAAS;oBACT,OAAO;wBAAE,QAAQ;oBAAO;oBACxB,OAAO,SAAS,AAAC,MAAiB,OAAZ,SAAQ,MAAc,OAAV,QAAO,KAAW,OAAR;mBARvC;;;;;8BAYP,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;;;;;;wBAEtB,uBACC,6LAAC;4BAAG,WAAU;sCAAuD;;;;;;sCAEvE,6LAAC;4BAAI,WAAU;;gCAA6D;gCACxE;gCAAO;gCAAE;;;;;;;;;;;;;8BAIf,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;sCAAI;;;;;;sCACL,6LAAC;4BAAI,WAAU;;gCAAe;gCAAQ,QAAQ;gCAAE;gCAAE,SAAS;;;;;;;wBAC1D,gBAAgB,QAAQ,mBACvB,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;8CACnF,6LAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;;;;;;;;yCAM3F,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;;;;;AAOjD;GArFwB;;QAUP,qIAAA,CAAA,YAAS;QACmC,qIAAA,CAAA,qBAAkB;;;KAXvD","debugId":null}},
    {"offset": {"line": 1432, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/app/watch/%5Bmediatype%5D/%5Bid%5D/page.tsx"],"sourcesContent":["// app/watch/[mediatype]/[id]/page.tsx\n'use client';\n\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport MoviePlayer from '@/components/players/MoviePlayer';\nimport TvPlayer from '@/components/players/TvPlayer';\nimport { tmdbApi } from '@/lib/api/tmdb';\n\nexport default function WatchPage() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [mediaData, setMediaData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  const mediaType = params?.mediatype as 'movie' | 'tv';\n  const id = parseInt(params?.id as string);\n\n  // Get season and episode from query params for TV shows (default to 1)\n  const season = parseInt(searchParams.get('season') || '1', 10);\n  const episode = parseInt(searchParams.get('episode') || '1', 10);\n\n  useEffect(() => {\n    // Hide body scroll for fullscreen experience\n    const prevOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.body.style.overflow = prevOverflow || 'auto';\n    };\n  }, []);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    async function loadMediaData() {\n      setLoading(true);\n      try {\n        let data;\n        if (mediaType === 'movie') {\n          data = await tmdbApi.getMovieDetails(id);\n        } else {\n          data = await tmdbApi.getTVShowDetails(id);\n        }\n        if (!cancelled) setMediaData(data);\n      } catch (error) {\n        console.error('Failed to load media:', error);\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n\n    if (id && (mediaType === 'movie' || mediaType === 'tv')) {\n      loadMediaData();\n    } else {\n      setLoading(false);\n    }\n\n    return () => { cancelled = true; };\n  }, [id, mediaType]);\n\n  const handleClose = () => {\n    router.back();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-2 border-white border-t-transparent mx-auto mb-4\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!mediaData && (mediaType === 'movie' || mediaType === 'tv')) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-xl font-semibold mb-4\">Media not found</h1>\n          <button\n            onClick={handleClose}\n            className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Determine a display title (movie.title or tv.name)\n  const title = mediaData?.title ?? mediaData?.name ?? '';\n\n  // Render correct player\n  if (mediaType === 'movie') {\n    return (\n      <MoviePlayer\n        mediaId={id}\n        mediaType=\"movie\"\n        title={title}\n        onClose={handleClose}\n      />\n    );\n  }\n\n  if (mediaType === 'tv') {\n    return (\n      <TvPlayer\n        mediaId={id}\n        mediaType=\"tv\"\n        season={season}\n        episode={episode}\n        title={title}\n        onClose={handleClose}\n        // optional tuning values ‚Äî tweak as desired:\n        guardMs={5000}\n        autoNextMs={25 * 60 * 1000} // auto-advance after ~25 minutes (optional)\n      />\n    );\n  }\n\n  // Fallback for unknown mediatype\n  return (\n    <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n      <div className=\"text-center\">\n        <h1 className=\"text-xl font-semibold mb-4\">Unsupported media type</h1>\n        <button\n          onClick={handleClose}\n          className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n        >\n          Go Back\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1663, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js","sources":["file:///home/flex/Atto4/node_modules/lucide-react/src/icons/arrow-left.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAC/C;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC3C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,SAAA,CAAA,CAAA,2KAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}