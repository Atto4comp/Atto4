{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/MoviePlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useEmbedAutoSwitch } from '@/lib/hooks/useEmbedAutoSwitch';\n\ninterface MoviePlayerProps {\n  mediaId: number;\n  title?: string;\n  onClose?: () => void;\n  guardMs?: number;\n  showControls?: boolean;\n}\n\nexport default function MoviePlayer({\n  mediaId,\n  title,\n  onClose,\n  guardMs = 6000,\n  showControls = true,\n}: MoviePlayerProps) {\n  const router = useRouter();\n  const { src, index, total, onLoad, onError, next, prev } = useEmbedAutoSwitch({\n    mediaType: 'movie',\n    mediaId,\n    guardMs,\n    preferServer: true,\n  });\n\n  const handleClose = () => (onClose ? onClose() : router.back());\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {src ? (\n        <>\n          <iframe\n            key={src}\n            src={src}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"autoplay; encrypted-media; picture-in-picture\"\n            onLoad={onLoad}\n            onError={onError}\n            style={{ border: 'none' }}\n            title={title || `movie-${mediaId}`}\n          />\n\n          {/* Back + Title */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 text-white\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg truncate max-w-xs\">{title}</h1>\n            )}\n          </div>\n\n          {/* Minimal overlay */}\n          <div className=\"absolute top-4 right-4 z-30 text-white/80 text-sm flex items-center gap-3\">\n            <div>Auto-switch enabled — Press ESC to exit</div>\n            <div className=\"text-xs ml-2\">Source {index + 1}/{total || 0}</div>\n            {showControls && total > 1 && (\n              <div className=\"ml-3 flex items-center gap-2\">\n                <button onClick={prev} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Prev</button>\n                <button onClick={next} className=\"px-2 py-1 bg-black/60 rounded hover:bg-black/80\">Next</button>\n              </div>\n            )}\n          </div>\n        </>\n      ) : (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white/70 text-sm\">Preparing player…</div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;;;;;AAHA;;;;;AAce,SAAS,YAAY,EAClC,OAAO,EACP,KAAK,EACL,OAAO,EACP,UAAU,IAAI,EACd,eAAe,IAAI,EACF;IACjB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,mBAAmB;QAC5E,WAAW;QACX;QACA;QACA,cAAc;IAChB;IAEA,MAAM,cAAc,IAAO,UAAU,YAAY,OAAO,IAAI;IAE5D,qBACE,8OAAC;QAAI,WAAU;kBACZ,oBACC;;8BACE,8OAAC;oBAEC,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;oBACN,QAAQ;oBACR,SAAS;oBACT,OAAO;wBAAE,QAAQ;oBAAO;oBACxB,OAAO,SAAS,CAAC,MAAM,EAAE,SAAS;mBAR7B;;;;;8BAYP,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,8OAAC,gNAAA,CAAA,YAAS;gCAAC,WAAU;;;;;;;;;;;wBAEtB,uBACC,8OAAC;4BAAG,WAAU;sCAAuD;;;;;;;;;;;;8BAKzE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;sCAAI;;;;;;sCACL,8OAAC;4BAAI,WAAU;;gCAAe;gCAAQ,QAAQ;gCAAE;gCAAE,SAAS;;;;;;;wBAC1D,gBAAgB,QAAQ,mBACvB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;8CACnF,8OAAC;oCAAO,SAAS;oCAAM,WAAU;8CAAkD;;;;;;;;;;;;;;;;;;;yCAM3F,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;;;;;AAKjD","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-common.ts"],"sourcesContent":["// lib/api/video-common.ts\nimport axios from 'axios';\n\n/**\n * Shared utilities, types and helpers for video APIs\n */\n\nexport interface VideoSource {\n  url: string;\n  quality: string;\n  type: \"iframe\";\n  servers: string;\n  tmdbId: number;\n  mediaType: \"movie\" | \"tv\";\n  season?: number;\n  episode?: number;\n  title?: string;\n  episodeTitle?: string;\n  responseTime?: number;\n  working?: boolean;\n  error?: string;\n  provider?: string;\n}\n\nexport interface VideoProvider {\n  name: string;\n  value: string;\n  priority: number;\n  mediaTypes: (\"movie\" | \"tv\")[];\n  isTemplate: boolean;\n  hostname: string;\n}\n\nexport interface EmbedCheckResponse {\n  success: boolean;\n  workingUrl?: {\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n  } | null;\n  totalTested: number;\n  workingCount: number;\n  allUrls: Array<{\n    provider: string;\n    url: string;\n    originalUrl: string;\n    type: string;\n    working: boolean;\n    responseTime?: number;\n    error?: string;\n  }>;\n  metadata: {\n    mediaType: string;\n    tmdbId: number;\n    season?: number;\n    episode?: number;\n    tested: boolean;\n    timestamp: string;\n  };\n}\n\n/** Shared ENV (generic fallback providers) */\nexport const COMMON_ENV = {\n  BASE: (process.env.NEXT_PUBLIC_VIDEO_API_BASE || \"\").trim(),\n  E1: (process.env.NEXT_PUBLIC_VIDEO_EMBED_1 || \"\").trim(),\n  E2: (process.env.NEXT_PUBLIC_VIDEO_EMBED_2 || \"\").trim(),\n  E3: (process.env.NEXT_PUBLIC_VIDEO_EMBED_3 || \"\").trim(),\n  E4: (process.env.NEXT_PUBLIC_VIDEO_EMBED_4 || \"\").trim(),\n  TMDB_API_KEY: (process.env.NEXT_PUBLIC_TMDB_API_KEY || \"\").trim()\n};\n\nexport const EXTRA_PARAMS = (process.env.NEXT_PUBLIC_VIDEO_URL_PARAMS || \"\").trim();\n\n/** Helpers */\nfunction isTemplateLocal(url?: string) {\n  if (!url) return false;\n  return /\\$\\{(id|type|season|episode)\\}/.test(url);\n}\n\nexport function getServerLabel(url: string): string {\n  if (!url) return 'Unknown Server';\n  try {\n    const hostname = new URL(url).hostname;\n    return hostname.replace(/^www\\./, '');\n  } catch {\n    return 'Unknown Server';\n  }\n}\n\nexport function normalizeBase(url: string) {\n  if (!url) return '';\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n}\n\nexport function appendParams(url: string, params: string) {\n  if (!params) return url;\n  return url + (url.includes('?') ? '&' : '?') + params;\n}\n\nexport function buildEmbedPath(mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  if (mediaType === 'movie') return `/movie/${tmdbId}`;\n  if (mediaType === 'tv') {\n    if (season && episode) return `/tv/${tmdbId}/${season}/${episode}`;\n    return `/tv/${tmdbId}`;\n  }\n  throw new Error('invalid mediaType');\n}\n\nexport function buildRawUrl(providerValue: string, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  if (!providerValue) throw new Error('providerValue required');\n  if (isTemplateLocal(providerValue)) {\n    return providerValue\n      .replace(/\\$\\{id\\}/g, String(tmdbId))\n      .replace(/\\$\\{type\\}/g, mediaType)\n      .replace(/\\$\\{season\\}/g, String(season || 1))\n      .replace(/\\$\\{episode\\}/g, String(episode || 1));\n  }\n  const base = normalizeBase(providerValue);\n  const path = buildEmbedPath(mediaType, tmdbId, season, episode);\n  return `${base}${path}`;\n}\n\nexport function buildEmbedUrl(providerValue: string, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  const raw = buildRawUrl(providerValue, mediaType, tmdbId, season, episode);\n  return appendParams(raw, EXTRA_PARAMS);\n}\n\nexport function getEmbedUrlCandidatesFromProviders(providers: VideoProvider[], mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number) {\n  const urls = providers.map(p => buildEmbedUrl(p.value, mediaType, tmdbId, season, episode));\n  return [...new Set(urls)];\n}\n\n/** Fallback provider list built from COMMON_ENV (used if module-specific providers are missing) */\nexport const COMMON_PROVIDERS: VideoProvider[] = [\n  { name: 'Primary', value: COMMON_ENV.E1, priority: 1, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E1), hostname: getServerLabel(COMMON_ENV.E1) },\n  { name: 'Secondary', value: COMMON_ENV.E2, priority: 2, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E2), hostname: getServerLabel(COMMON_ENV.E2) },\n  { name: 'Tertiary', value: COMMON_ENV.E3, priority: 3, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E3), hostname: getServerLabel(COMMON_ENV.E3) },\n  { name: 'Backup', value: COMMON_ENV.E4, priority: 4, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.E4), hostname: getServerLabel(COMMON_ENV.E4) },\n  { name: 'Base', value: COMMON_ENV.BASE, priority: 5, mediaTypes: ['movie','tv'], isTemplate: isTemplateLocal(COMMON_ENV.BASE), hostname: getServerLabel(COMMON_ENV.BASE) }\n].filter(p => !!p.value);\n\n/** checkEmbedUrls helper (client convenience: calls your /api/check-embed route) */\nexport async function checkEmbedUrls(mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number, testUrls: boolean = true): Promise<EmbedCheckResponse | null> {\n  try {\n    const res = await fetch('/api/check-embed', {\n      method: 'POST',\n      headers: {'content-type':'application/json'},\n      body: JSON.stringify({ mediaType, tmdbId, season, episode, testUrls })\n    });\n    if (!res.ok) return null;\n    const payload = await res.json();\n    return payload as EmbedCheckResponse;\n  } catch (err) {\n    console.error('checkEmbedUrls error', err);\n    return null;\n  }\n}\n\n/** resolveTmdbId helper (numeric or imdb -> tmdb) */\nexport async function resolveTmdbId(input: string | number, type: \"movie\" | \"tv\"): Promise<number | null> {\n  if (typeof input === 'number' && Number.isFinite(input)) return input;\n  const s = String(input).trim();\n  if (!s) return null;\n  const asNum = Number(s);\n  if (Number.isFinite(asNum)) return asNum;\n  if (/^tt\\d+$/i.test(s)) {\n    if (!COMMON_ENV.TMDB_API_KEY) return null;\n    try {\n      const { data } = await axios.get(`https://api.themoviedb.org/3/find/${s}`, {\n        params: { api_key: COMMON_ENV.TMDB_API_KEY, external_source: 'imdb_id' },\n        timeout: 5000\n      });\n      const results = type === 'movie' ? data.movie_results : data.tv_results;\n      return results?.[0]?.id ?? null;\n    } catch (err) {\n      console.warn('resolveTmdbId failed', err);\n      return null;\n    }\n  }\n  return null;\n}\n\n/** create VideoSource object */\nexport function createVideoSourceFromProvider(provider: VideoProvider, mediaType: \"movie\" | \"tv\", tmdbId: number, season?: number, episode?: number, additional: Partial<VideoSource> = {}): VideoSource {\n  const url = buildEmbedUrl(provider.value, mediaType, tmdbId, season, episode);\n  return {\n    url,\n    quality: 'HD',\n    type: 'iframe',\n    servers: `${provider.name} (${provider.hostname})`,\n    tmdbId,\n    mediaType,\n    season,\n    episode,\n    provider: provider.name,\n    ...additional\n  };\n}\n\n/** config validator */\nexport function validateConfiguration(providers: VideoProvider[] = COMMON_PROVIDERS) {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n  if (!providers || providers.length === 0) errors.push('No providers configured');\n  if (!COMMON_ENV.TMDB_API_KEY) warnings.push('TMDB API key not set (imdb resolution disabled)');\n  return { isValid: errors.length === 0, errors, warnings };\n}\n\nexport { COMMON_ENV as ENV, COMMON_PROVIDERS };\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 378, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/lib/api/video-tv.ts"],"sourcesContent":["import { getServerLabel } from './video-common';\n\ninterface TVEmbedResult {\n  embedUrl: string;\n  provider: string;\n}\n\nfunction getTVProviders() {\n  const providers = [\n    process.env.NEXT_PUBLIC_TV_EMBED_1 || \"https://cinemaos.tech/player/${id}/${season}/${episode}\",\n    process.env.NEXT_PUBLIC_TV_EMBED_2 || \"\",\n    process.env.NEXT_PUBLIC_TV_EMBED_3 || \"\",\n    process.env.NEXT_PUBLIC_TV_EMBED_4 || \"\",\n    process.env.NEXT_PUBLIC_TV_API_BASE || \"\",\n  ].filter(p => p.trim());\n  \n  return providers.length > 0 ? providers : [\"https://cinemaos.tech/player/${id}/${season}/${episode}\"];\n}\n\n// ✅ FAST: Direct URL building - no validation overhead\nexport function getTVEmbed(id: string | number): TVEmbedResult {\n  const providers = getTVProviders();\n  const providerUrl = providers[0];\n\n  // Direct template replacement - instant\n  const embedUrl = providerUrl\n    .replace(/\\$\\{id\\}/g, String(id))\n    .replace(/\\$\\{season\\}/g, '1')\n    .replace(/\\$\\{episode\\}/g, '1');\n\n  return {\n    embedUrl,\n    provider: getServerLabel(providerUrl)\n  };\n}\n\nexport default { getTVEmbed };\n"],"names":[],"mappings":";;;;AAAA;;AAOA,SAAS;IACP,MAAM,YAAY;QAChB,QAAQ,GAAG,CAAC,sBAAsB,IAAI;QACtC,QAAQ,GAAG,CAAC,sBAAsB,IAAI;QACtC,QAAQ,GAAG,CAAC,sBAAsB,IAAI;QACtC,QAAQ,GAAG,CAAC,sBAAsB,IAAI;QACtC,QAAQ,GAAG,CAAC,uBAAuB,IAAI;KACxC,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI;IAEpB,OAAO,UAAU,MAAM,GAAG,IAAI,YAAY;QAAC;KAA0D;AACvG;AAGO,SAAS,WAAW,EAAmB;IAC5C,MAAM,YAAY;IAClB,MAAM,cAAc,SAAS,CAAC,EAAE;IAEhC,wCAAwC;IACxC,MAAM,WAAW,YACd,OAAO,CAAC,aAAa,OAAO,KAC5B,OAAO,CAAC,iBAAiB,KACzB,OAAO,CAAC,kBAAkB;IAE7B,OAAO;QACL;QACA,UAAU,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;IAC3B;AACF;uCAEe;IAAE;AAAW","debugId":null}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/players/TvPlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { getTVEmbed } from '@/lib/api/video-tv';\n\ninterface TvPlayerProps {\n  mediaId: number | string;\n  title?: string;\n  onClose?: () => void;\n}\n\nexport default function TvPlayer({ mediaId, title, onClose }: TvPlayerProps) {\n  const [embedUrl, setEmbedUrl] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  \n  const router = useRouter();\n\n  useEffect(() => {\n    // ✅ INSTANT: No async calls, no validation delays\n    const result = getTVEmbed(mediaId);\n    setEmbedUrl(result.embedUrl);\n    setLoading(false);\n    \n    console.log(`TV embed: ${result.embedUrl}`);\n  }, [mediaId]);\n\n  const handleClose = () => onClose ? onClose() : router.back();\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 z-50 bg-black flex items-center justify-center\">\n        <div className=\"text-white\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      <iframe\n        src={embedUrl}\n        className=\"w-full h-full\"\n        allowFullScreen\n        allow=\"autoplay; encrypted-media; picture-in-picture\"\n        style={{ border: 'none' }}\n      />\n      \n      <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n        <button\n          onClick={handleClose}\n          className=\"p-2 rounded-full bg-black/60 text-white hover:bg-black/80\"\n        >\n          <ArrowLeft className=\"w-6 h-6\" />\n        </button>\n        {title && (\n          <h1 className=\"text-white font-bold text-lg\">{title}</h1>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAae,SAAS,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAiB;IACzE,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;IACjD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,kDAAkD;QAClD,MAAM,SAAS,CAAA,GAAA,yHAAA,CAAA,aAAU,AAAD,EAAE;QAC1B,YAAY,OAAO,QAAQ;QAC3B,WAAW;QAEX,QAAQ,GAAG,CAAC,CAAC,UAAU,EAAE,OAAO,QAAQ,EAAE;IAC5C,GAAG;QAAC;KAAQ;IAEZ,MAAM,cAAc,IAAM,UAAU,YAAY,OAAO,IAAI;IAE3D,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BAAa;;;;;;;;;;;IAGlC;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,KAAK;gBACL,WAAU;gBACV,eAAe;gBACf,OAAM;gBACN,OAAO;oBAAE,QAAQ;gBAAO;;;;;;0BAG1B,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,WAAU;kCAEV,cAAA,8OAAC,gNAAA,CAAA,YAAS;4BAAC,WAAU;;;;;;;;;;;oBAEtB,uBACC,8OAAC;wBAAG,WAAU;kCAAgC;;;;;;;;;;;;;;;;;;AAKxD","debugId":null}},
    {"offset": {"line": 517, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/app/watch/%5Bmediatype%5D/%5Bid%5D/page.tsx"],"sourcesContent":["// app/watch/[mediatype]/[id]/page.tsx\n'use client';\n\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport MoviePlayer from '@/components/players/MoviePlayer';\nimport TvPlayer from '@/components/players/TvPlayer';\nimport { tmdbApi } from '@/lib/api/tmdb';\n\nexport default function WatchPage() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [mediaData, setMediaData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  const mediaType = params?.mediatype as 'movie' | 'tv';\n  const id = parseInt(params?.id as string, 10);\n\n  // Get season and episode from query params for TV shows (default to 1)\n  const season = parseInt(searchParams.get('season') || '1', 10);\n  const episode = parseInt(searchParams.get('episode') || '1', 10);\n\n  useEffect(() => {\n    // Hide body scroll for fullscreen experience\n    const prevOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.body.style.overflow = prevOverflow || 'auto';\n    };\n  }, []);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    async function loadMediaData() {\n      setLoading(true);\n      try {\n        let data = null;\n        if (mediaType === 'movie') {\n          data = await tmdbApi.getMovieDetails(id);\n        } else if (mediaType === 'tv') {\n          data = await tmdbApi.getTVShowDetails(id);\n        }\n\n        if (!cancelled) setMediaData(data);\n      } catch (error) {\n        console.error('Failed to load media:', error);\n        if (!cancelled) setMediaData(null);\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n\n    if (id && (mediaType === 'movie' || mediaType === 'tv')) {\n      loadMediaData();\n    } else {\n      setLoading(false);\n    }\n\n    return () => { cancelled = true; };\n  }, [id, mediaType]);\n\n  const handleClose = () => {\n    router.back();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-2 border-white border-t-transparent mx-auto mb-4\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!mediaData && (mediaType === 'movie' || mediaType === 'tv')) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-xl font-semibold mb-4\">Media not found</h1>\n          <button\n            onClick={handleClose}\n            className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Determine a display title (movie.title or tv.name)\n  const title = mediaData?.title ?? mediaData?.name ?? '';\n\n  // Render correct player\n  if (mediaType === 'movie') {\n    return (\n      <MoviePlayer\n        mediaId={id}\n        title={title}\n        onClose={handleClose}\n        // optional tuning:\n        guardMs={6000}\n        showControls={true}\n      />\n    );\n  }\n\n  if (mediaType === 'tv') {\n    return (\n      <TvPlayer\n        mediaId={id}\n        season={season}\n        episode={episode}\n        title={title}\n        onClose={handleClose}\n        // optional tuning values — tweak as desired:\n        guardMs={5000}\n        autoNextMs={25 * 60 * 1000} // auto-advance after ~25 minutes (optional)\n        showControls={true}\n      />\n    );\n  }\n\n  // Fallback for unknown mediatype\n  return (\n    <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n      <div className=\"text-center\">\n        <h1 className=\"text-xl font-semibold mb-4\">Unsupported media type</h1>\n        <button\n          onClick={handleClose}\n          className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n        >\n          Go Back\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 727, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js","sources":["file:///home/flex/Atto4/node_modules/lucide-react/src/icons/arrow-left.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAC/C;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC3C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,SAAA,CAAA,CAAA,wKAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}