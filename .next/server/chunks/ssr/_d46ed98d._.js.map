{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/components/player/VideoPlayer.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { ArrowLeft } from 'lucide-react';\nimport { useVideoUrlSwitcher } from '@/app/hooks/useVideoUrlSwitcher';\n\ninterface VideoPlayerProps {\n  mediaId: number;\n  mediaType: 'movie' | 'tv';\n  season?: number;\n  episode?: number;\n  title?: string;\n  onClose?: () => void;\n}\n\ninterface VideoSource {\n  provider: string;\n  url: string;\n  originalUrl?: string;\n  type?: string;\n  working?: boolean;\n  responseTime?: number;\n  error?: string;\n}\n\nexport default function VideoPlayer({\n  mediaId,\n  mediaType,\n  season,\n  episode,\n  title,\n  onClose\n}: VideoPlayerProps) {\n  const [sources, setSources] = useState<VideoSource[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isTesting, setIsTesting] = useState(false);\n\n  const iframeRef = useRef<HTMLIFrameElement | null>(null);\n  const loadWatchdogRef = useRef<number | null>(null); // stores setTimeout id (window)\n  const cancelledRef = useRef(false);\n  const router = useRouter();\n\n  // Use the video URL switcher hook\n  const {\n    currentSource,\n    currentIndex,\n    totalSources,\n    hasNext,\n    switchToNext,\n    workingCount,\n    failedCount\n  } = useVideoUrlSwitcher(sources);\n\n  // clear watchdog\n  const clearLoadWatchdog = useCallback(() => {\n    if (loadWatchdogRef.current) {\n      clearTimeout(loadWatchdogRef.current);\n      loadWatchdogRef.current = null;\n    }\n  }, []);\n\n  // Start a watchdog when iframe src changes (auto-switch if not loaded in time)\n  useEffect(() => {\n    // Clear previous watchdog always\n    clearLoadWatchdog();\n\n    if (!currentSource) return;\n\n    // If an immediate error condition exists, try next\n    if (currentSource.working === false) {\n      // skip immediately\n      if (hasNext) {\n        switchToNext();\n        return;\n      } else {\n        setError('All video sources failed to load');\n        return;\n      }\n    }\n\n    // Start a 15s watchdog ‚Äî if iframe doesn't call onLoad within that time, treat it as failed\n    const WATCHDOG_MS = 15000;\n    loadWatchdogRef.current = window.setTimeout(() => {\n      console.warn(`‚è±Ô∏è Watchdog: iframe did not finish loading within ${WATCHDOG_MS}ms for ${currentSource.provider}`);\n      // attempt switching\n      if (hasNext) {\n        switchToNext();\n      } else {\n        setError('All video sources failed to load (timeout)');\n      }\n    }, WATCHDOG_MS);\n\n    return () => {\n      clearLoadWatchdog();\n    };\n  }, [currentSource, hasNext, switchToNext, clearLoadWatchdog]);\n\n  // Fetch working URLs from enhanced API\n  useEffect(() => {\n    cancelledRef.current = false;\n\n    async function fetchSources() {\n      setLoading(true);\n      setError(null);\n      setIsTesting(true);\n\n      try {\n        console.log(`üîç Fetching video sources for ${mediaType} ${mediaId}${mediaType === 'tv' ? ` S${season}E${episode}` : ''}...`);\n\n        const response = await fetch('/api/check-embed', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            mediaType,\n            tmdbId: mediaId,\n            season: season || 1,\n            episode: episode || 1,\n            testUrls: true\n          })\n        });\n\n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n\n        const data = await response.json();\n\n        if (cancelledRef.current) return;\n\n        // Normalize data.allUrls into VideoSource[]\n        const raw = Array.isArray(data.allUrls) ? data.allUrls : [];\n        const normalized: VideoSource[] = raw.map((item: any) => {\n          if (typeof item === 'string') {\n            return {\n              provider: 'unknown',\n              url: item,\n              originalUrl: item,\n              type: 'embed',\n              working: true\n            } as VideoSource;\n          } else if (typeof item === 'object' && item !== null) {\n            // ensure url exists\n            return {\n              provider: item.provider || item.host || 'unknown',\n              url: item.url || item.src || '',\n              originalUrl: item.originalUrl || item.url || item.src || '',\n              type: item.type || 'embed',\n              working: typeof item.working === 'boolean' ? item.working : true,\n              responseTime: item.responseTime,\n              error: item.error\n            } as VideoSource;\n          } else {\n            return {\n              provider: 'unknown',\n              url: String(item),\n              originalUrl: String(item),\n              type: 'embed',\n              working: true\n            } as VideoSource;\n          }\n        }).filter(s => typeof s.url === 'string' && s.url.length > 0);\n\n        if (normalized.length === 0) {\n          throw new Error('No video sources returned by API');\n        }\n\n        // Prefer sources explicitly marked working; otherwise use all\n        const workingSources = normalized.filter(s => s.working !== false);\n        const chosen = workingSources.length > 0 ? workingSources : normalized;\n\n        console.log(`‚úÖ Found ${chosen.length} sources (${workingSources.length} working, ${normalized.length - workingSources.length} untested/failed)`);\n        setSources(chosen);\n      } catch (err) {\n        console.error('Failed to fetch video sources:', err);\n        if (!cancelledRef.current) {\n          setError(`Failed to load video sources: ${err instanceof Error ? err.message : 'Unknown error'}`);\n          setSources([]);\n        }\n      } finally {\n        if (!cancelledRef.current) {\n          setLoading(false);\n          setIsTesting(false);\n        }\n      }\n    }\n\n    fetchSources();\n\n    return () => {\n      cancelledRef.current = true;\n    };\n  }, [mediaType, mediaId, season, episode]);\n\n  // Handle iframe errors with automatic switching\n  const handleIframeError = useCallback(() => {\n    console.log('üö´ iframe error handler fired ‚Äî trying next source...');\n    clearLoadWatchdog();\n    if (hasNext) {\n      switchToNext();\n    } else {\n      setError('All video sources failed to load');\n    }\n  }, [hasNext, switchToNext, clearLoadWatchdog]);\n\n  // Handle successful load\n  const handleIframeLoad = useCallback(() => {\n    clearLoadWatchdog();\n    if (currentSource) {\n      console.log(`‚úÖ Successfully loaded: ${currentSource.provider} [${currentSource.type}]`);\n      setError(null);\n    } else {\n      console.log('‚úÖ iframe loaded but no currentSource present');\n    }\n  }, [currentSource, clearLoadWatchdog]);\n\n  // Handle close\n  const handleClose = useCallback(() => {\n    if (onClose) onClose();\n    else router.back();\n  }, [onClose, router]);\n\n  // Handle ESC key\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') handleClose();\n    };\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [handleClose]);\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black\">\n      {/* Loading State */}\n      {(loading || isTesting) && (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white text-center\">\n            <div className=\"animate-spin rounded-full h-16 w-16 border-4 border-white border-t-transparent mb-6 mx-auto\"></div>\n            <p className=\"text-xl mb-2\">\n              {isTesting ? 'Testing video sources...' : 'Loading video sources...'}\n            </p>\n            <p className=\"text-sm text-gray-400\">Finding the best server for you</p>\n            {totalSources > 0 && (\n              <p className=\"text-xs text-gray-500 mt-2\">\n                {workingCount}/{totalSources} servers available\n              </p>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Error State */}\n      {error && !loading && !isTesting && (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white text-center max-w-md px-6\">\n            <div className=\"text-6xl mb-6\">‚ö†Ô∏è</div>\n            <h2 className=\"text-2xl font-bold mb-4\">Unable to Play Video</h2>\n            <p className=\"text-gray-300 mb-4\">{error}</p>\n            {totalSources > 0 && (\n              <div className=\"text-sm text-gray-400 mb-6\">\n                <p>Tested {totalSources} different servers</p>\n                {workingCount > 0 && (\n                  <p>{workingCount} servers were initially available</p>\n                )}\n                {failedCount > 0 && (\n                  <p>{failedCount} servers failed during testing</p>\n                )}\n              </div>\n            )}\n            <button\n              onClick={handleClose}\n              className=\"px-8 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium transition-colors\"\n            >\n              Go Back\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Video Player */}\n      {currentSource && !loading && !error && !isTesting && (\n        <>\n          <iframe\n            ref={iframeRef}\n            key={currentSource.url} // Force re-render on URL change\n            src={currentSource.url}\n            className=\"w-full h-full\"\n            allowFullScreen\n            allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n            onError={handleIframeError}\n            onLoad={handleIframeLoad}\n            style={{ border: 'none' }}\n            title={title || `player-${mediaType}-${mediaId}`}\n          />\n\n          {/* Top-left Back + Title */}\n          <div className=\"absolute top-4 left-4 z-30 flex items-center gap-3\">\n            <button\n              onClick={handleClose}\n              className=\"p-2 rounded-full bg-black/60 backdrop-blur-sm text-white hover:bg-black/80 transition-colors\"\n              aria-label=\"Back\"\n            >\n              <ArrowLeft className=\"w-6 h-6\" />\n            </button>\n            {title && (\n              <h1 className=\"text-white font-extrabold text-lg sm:text-xl truncate max-w-xs sm:max-w-md\">\n                {title}\n              </h1>\n            )}\n          </div>\n\n          {/* Enhanced Controls Overlay */}\n          <div className=\"absolute top-4 right-4 text-white/70 text-sm pointer-events-none\">\n            <div>Auto-switch enabled ‚Äî Press ESC to exit</div>\n            {totalSources > 1 && (\n              <div className=\"text-xs mt-1\">\n                Source {currentIndex + 1}/{totalSources} ‚Ä¢ {workingCount} available\n              </div>\n            )}\n          </div>\n\n          {/* Debug Info */}\n          <div className=\"absolute bottom-4 left-4 z-30 bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2\">\n            <div className=\"text-white text-xs\">\n              <div className=\"font-medium\">\n                {currentSource.provider} [{currentSource.type}]\n              </div>\n              {currentSource.responseTime && (\n                <div className=\"text-gray-300 mt-1\">\n                  Response: {currentSource.responseTime}ms\n                </div>\n              )}\n              {hasNext && (\n                <div className=\"text-gray-400 text-xs mt-1\">\n                  {totalSources - currentIndex - 1} backup sources available\n                </div>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n\n      {/* No Sources Available */}\n      {!currentSource && !loading && !error && !isTesting && (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <div className=\"text-white text-center\">\n            <div className=\"text-4xl mb-4\">üì∫</div>\n            <h2 className=\"text-xl font-bold mb-2\">No Video Sources Available</h2>\n            <p className=\"text-gray-400 mb-6\">Unable to find any playable video sources for this content</p>\n            <button\n              onClick={handleClose}\n              className=\"px-8 py-3 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium transition-colors\"\n            >\n              Go Back\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 554, "column": 0}, "map": {"version":3,"sources":["file:///home/flex/Atto4/app/watch/%5Bmediatype%5D/%5Bid%5D/page.tsx"],"sourcesContent":["// app/watch/[mediatype]/[id]/page.tsx\n'use client';\n\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport VideoPlayer from '@/components/player/VideoPlayer';\nimport { tmdbApi } from '@/lib/api/tmdb';\n\nexport default function WatchPage() {\n  const params = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const [mediaData, setMediaData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  const mediaType = params?.mediatype as 'movie' | 'tv';\n  const id = parseInt(params?.id as string);\n  \n  // Get season and episode from query params for TV shows\n  const season = parseInt(searchParams.get('season') || '1');\n  const episode = parseInt(searchParams.get('episode') || '1');\n\n  useEffect(() => {\n    // Hide body scroll for fullscreen experience\n    document.body.style.overflow = 'hidden';\n    \n    return () => {\n      document.body.style.overflow = 'auto';\n    };\n  }, []);\n\n  useEffect(() => {\n    async function loadMediaData() {\n      try {\n        let data;\n        if (mediaType === 'movie') {\n          data = await tmdbApi.getMovieDetails(id);\n        } else {\n          data = await tmdbApi.getTVShowDetails(id);\n        }\n        setMediaData(data);\n      } catch (error) {\n        console.error('Failed to load media:', error);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    if (id && mediaType) {\n      loadMediaData();\n    }\n  }, [id, mediaType]);\n\n  const handleClose = () => {\n    router.back();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center\">\n        <div className=\"text-white text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-2 border-white border-t-transparent mx-auto mb-4\"></div>\n          <p>Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!mediaData) {\n    return (\n      <div className=\"fixed inset-0 bg-black flex items-center justify-center text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-xl font-semibold mb-4\">Media not found</h1>\n          <button\n            onClick={handleClose}\n            className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const title = mediaData.title || mediaData.name;\n\n  return (\n    <VideoPlayer\n      mediaId={id}\n      mediaType={mediaType}\n      title={title}\n      season={mediaType === 'tv' ? season : undefined}\n      episode={mediaType === 'tv' ? episode : undefined}\n      onClose={handleClose}\n    />\n  );\n}\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;AAGtC;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,eAAe,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAO;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,YAAY,QAAQ;IAC1B,MAAM,KAAK,SAAS,QAAQ;IAE5B,wDAAwD;IACxD,MAAM,SAAS,SAAS,aAAa,GAAG,CAAC,aAAa;IACtD,MAAM,UAAU,SAAS,aAAa,GAAG,CAAC,cAAc;IAExD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,6CAA6C;QAC7C,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QAE/B,OAAO;YACL,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;QACjC;IACF,GAAG,EAAE;IAEL,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,eAAe;YACb,IAAI;gBACF,IAAI;gBACJ,IAAI,cAAc,SAAS;oBACzB,OAAO,MAAM,kHAAA,CAAA,UAAO,CAAC,eAAe,CAAC;gBACvC,OAAO;oBACL,OAAO,MAAM,kHAAA,CAAA,UAAO,CAAC,gBAAgB,CAAC;gBACxC;gBACA,aAAa;YACf,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,yBAAyB;YACzC,SAAU;gBACR,WAAW;YACb;QACF;QAEA,IAAI,MAAM,WAAW;YACnB;QACF;IACF,GAAG;QAAC;QAAI;KAAU;IAElB,MAAM,cAAc;QAClB,OAAO,IAAI;IACb;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;kCAAE;;;;;;;;;;;;;;;;;IAIX;IAEA,IAAI,CAAC,WAAW;QACd,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAC3C,8OAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;IAMT;IAEA,MAAM,QAAQ,UAAU,KAAK,IAAI,UAAU,IAAI;IAE/C,qBACE,8OAAC,oIAAA,CAAA,UAAW;QACV,SAAS;QACT,WAAW;QACX,OAAO;QACP,QAAQ,cAAc,OAAO,SAAS;QACtC,SAAS,cAAc,OAAO,UAAU;QACxC,SAAS;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 698, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js","sources":["file:///home/flex/Atto4/node_modules/lucide-react/src/icons/arrow-left.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAC/C;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC3C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,SAAA,CAAA,CAAA,wKAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}